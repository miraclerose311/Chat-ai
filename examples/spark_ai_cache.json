{"key": "web_search:2022 USA national auto sales by brand", "value": "[{'title': 'Full-Year 2022 National Auto Sales By Brand', 'link': 'https://www.carpro.com/blog/full-year-2022-national-auto-sales-by-brand', 'snippet': 'Jan 12, 2023 ... Full-Year 2022 National Auto Sales By Brand ; 1. Toyota, 1,849,751 ; 2. Ford, 1,767,439 ; 3. Chevrolet, 1,502,389 ; 4. Honda, 881,201\\xa0...'}, {'title': '2022 U.S. Auto Sales Figures by Brand | GCBC', 'link': 'https://www.goodcarbadcar.net/2022-us-vehicle-sales-figures-by-brand/', 'snippet': '2022 US Vehicle Sales Figures By Brand. Comprehensive data tables and charts for automotive sales in the United States. Home.'}, {'title': 'USA - Flash report, Automotive sales volume, 2023 - MarkLines ...', 'link': 'https://www.marklines.com/en/statistics/flash_sales/automotive-sales-in-usa-by-month', 'snippet': 'Light vehicle seasonally adjusted annualized sales (SAAR) for February 2023 was 15.19 million units versus 13.96 million units one year ago. With its vehicle\\xa0...'}, {'title': 'August U.S. auto sales: Toyota, Honda skid again; Ford, Hyundai ...', 'link': 'https://www.autonews.com/sales/august-us-auto-sales-toyota-honda-skid-again-ford-hyundai-kia-post-double-digit-august-gains', 'snippet': 'Sep 1, 2022 ... LMC Automotive on Friday slashed its outlook for 2022 sales to 13.8 million from 14.3 million. S&P Global Mobility last week reduced its\\xa0...'}, {'title': 'NADA Releases Third Quarter 2022 U.S. Auto Sales Analysis | NADA', 'link': 'https://www.nada.org/nada/press-releases/nada-releases-third-quarter-2022-us-auto-sales-analysis', 'snippet': 'Oct 12, 2022 ... The third quarter of 2022 closed with a new light-vehicle sales totaling a quarterly average SAAR of 13.3 million units, down slightly from a\\xa0...'}, {'title': 'Hybrid-Electric, Plug-in Hybrid-Electric and Electric Vehicle Sales ...', 'link': 'https://www.bts.gov/content/gasoline-hybrid-and-electric-vehicle-sales', 'snippet': '21, 2022. Publications: National Transportation Statistics Table 1-19.'}, {'title': 'NADA Issues Analysis of 2022 Auto Sales and 2023 Sales Forecast ...', 'link': 'https://www.nada.org/nada/press-releases/nada-issues-analysis-2022-auto-sales-and-2023-sales-forecast', 'snippet': 'Jan 11, 2023 ... In 2023, NADA anticipates new-vehicle sales of 14.6 million units \u2013 an increase of 6.6% from 2022. At the macro level, inflation has begun to\\xa0...'}, {'title': 'Light Duty Electric Drive Vehicles Monthly Sales Updates | Argonne ...', 'link': 'https://www.anl.gov/esia/light-duty-electric-drive-vehicles-monthly-sales-updates', 'snippet': 'Zhou, \\u200b\u201cRegional Variation in Light-Duty Plug-in Electric Vehicle Emissions,\u201d Argonne National Laboratory, Lemont, IL USA, ANL/ESD-22/34, 2022. Y. Zhou, D.'}, {'title': 'Market Beat | NADA', 'link': 'https://www.nada.org/nada/research-and-data/market-beat', 'snippet': 'New light-vehicle sales in May 2023 were up 19.6% compared with May 2022. ... As vehicle availability has improved, manufacturer incentives have increased.'}, {'title': 'Cox Automotive Forecast: August U.S. Auto Sales Languish at Slow ...', 'link': 'https://www.coxautoinc.com/news/cox-automotive-forecast-august-2022-u-s-auto-sales-forecast/', 'snippet': 'Aug 25, 2022 ... August 2022 numbers illustrate just how difficult forecasting new-vehicle sales has become. On the one hand, the national daily sales rate\\xa0...'}]"}
{"key": "Given a Query and a list of Google Search Results, return the link\nfrom a reputable website which contains the data set to answer the question. {''}\nQuery:2022 USA national auto sales by brand\nGoogle Search Results: \n```\n[{'title': 'Full-Year 2022 National Auto Sales By Brand', 'link': 'https://www.carpro.com/blog/full-year-2022-national-auto-sales-by-brand', 'snippet': 'Jan 12, 2023 ... Full-Year 2022 National Auto Sales By Brand ; 1. Toyota, 1,849,751 ; 2. Ford, 1,767,439 ; 3. Chevrolet, 1,502,389 ; 4. Honda, 881,201\\xa0...'}, {'title': '2022 U.S. Auto Sales Figures by Brand | GCBC', 'link': 'https://www.goodcarbadcar.net/2022-us-vehicle-sales-figures-by-brand/', 'snippet': '2022 US Vehicle Sales Figures By Brand. Comprehensive data tables and charts for automotive sales in the United States. Home.'}, {'title': 'USA - Flash report, Automotive sales volume, 2023 - MarkLines ...', 'link': 'https://www.marklines.com/en/statistics/flash_sales/automotive-sales-in-usa-by-month', 'snippet': 'Light vehicle seasonally adjusted annualized sales (SAAR) for February 2023 was 15.19 million units versus 13.96 million units one year ago. With its vehicle\\xa0...'}, {'title': 'August U.S. auto sales: Toyota, Honda skid again; Ford, Hyundai ...', 'link': 'https://www.autonews.com/sales/august-us-auto-sales-toyota-honda-skid-again-ford-hyundai-kia-post-double-digit-august-gains', 'snippet': 'Sep 1, 2022 ... LMC Automotive on Friday slashed its outlook for 2022 sales to 13.8 million from 14.3 million. S&P Global Mobility last week reduced its\\xa0...'}, {'title': 'NADA Releases Third Quarter 2022 U.S. Auto Sales Analysis | NADA', 'link': 'https://www.nada.org/nada/press-releases/nada-releases-third-quarter-2022-us-auto-sales-analysis', 'snippet': 'Oct 12, 2022 ... The third quarter of 2022 closed with a new light-vehicle sales totaling a quarterly average SAAR of 13.3 million units, down slightly from a\\xa0...'}, {'title': 'Hybrid-Electric, Plug-in Hybrid-Electric and Electric Vehicle Sales ...', 'link': 'https://www.bts.gov/content/gasoline-hybrid-and-electric-vehicle-sales', 'snippet': '21, 2022. Publications: National Transportation Statistics Table 1-19.'}, {'title': 'NADA Issues Analysis of 2022 Auto Sales and 2023 Sales Forecast ...', 'link': 'https://www.nada.org/nada/press-releases/nada-issues-analysis-2022-auto-sales-and-2023-sales-forecast', 'snippet': 'Jan 11, 2023 ... In 2023, NADA anticipates new-vehicle sales of 14.6 million units \u2013 an increase of 6.6% from 2022. At the macro level, inflation has begun to\\xa0...'}, {'title': 'Light Duty Electric Drive Vehicles Monthly Sales Updates | Argonne ...', 'link': 'https://www.anl.gov/esia/light-duty-electric-drive-vehicles-monthly-sales-updates', 'snippet': 'Zhou, \\u200b\u201cRegional Variation in Light-Duty Plug-in Electric Vehicle Emissions,\u201d Argonne National Laboratory, Lemont, IL USA, ANL/ESD-22/34, 2022. Y. Zhou, D.'}, {'title': 'Market Beat | NADA', 'link': 'https://www.nada.org/nada/research-and-data/market-beat', 'snippet': 'New light-vehicle sales in May 2023 were up 19.6% compared with May 2022. ... As vehicle availability has improved, manufacturer incentives have increased.'}, {'title': 'Cox Automotive Forecast: August U.S. Auto Sales Languish at Slow ...', 'link': 'https://www.coxautoinc.com/news/cox-automotive-forecast-august-2022-u-s-auto-sales-forecast/', 'snippet': 'Aug 25, 2022 ... August 2022 numbers illustrate just how difficult forecasting new-vehicle sales has become. On the one hand, the national daily sales rate\\xa0...'}]\n```\nThe answer MUST contain the url link only\n", "value": "https://www.carpro.com/blog/full-year-2022-national-auto-sales-by-brand"}
{"key": "https://www.carpro.com/blog/full-year-2022-national-auto-sales-by-brand", "value": "\n\n\nFull-Year 2022 National Auto Sales By Brand\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n  <img  src=\"https://data.adxcel-ec2.com/pixel/?ad_log=referer&amp;action=lead&amp;pixid=b719b86c-f9d4-4c28-a8a8-135a5ff2099d\" width=\"1\" height=\"1\" border=\"0\">\n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSearch\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCreate Account\n\n\n\n\n\n\n\n\nLogin\n\n\n\n\n\n\n\n\nCarPro You have a friend.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nListen Live\n\n\n\n\n\nBuy a Car\n\nFind a CarPro Friend\nFind a Car\n\nSell Your Car\nCar Buying Resources\n\nCar Reviews\nFAQs\nNews\nLaura's Auto News\n\nRadio Show\n\nRadio Schedule\nRadio Blog\nDealer True Stories\nCarPro Radio Show Podcast\nDriving N Heels Podcast\nCarPro Radio Show Newsletter\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nListen Live\n\n\n\n\n\n\n\nMenu\n\n\n\n\n\n\n\n\n\n\n\n\nNews,\u00a0\n          \n\nAuto Sales\n\n\nFull-Year 2022 National Auto Sales By Brand\nWritten by Jerry Reynolds\nJanuary 12, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nShare: \n\n\n\nFacebook\n\n\n\n\n\n\n\nTwitter\n\n\n\n\n\n\n\nLinkedIn\n\n\n\n\n\n\n\nEmail\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIt was a challenging year for the auto industry, primarily due to the microchip shortages, and certainly rising interest rates did not help.\u00a0 There was also a noticeable lack of incentives from the automakers, and lease deals were not nearly as good as in years past.\n\nDecember showed some sparks of life for many car companies, as sales rose 7.2%, but not enough to put the sales numbers over the 14 million mark, making 2022 sales the lowest since 2011.\nGeneral Motors regained the #1 sales leadership spot, wrestling it away from Toyota, which was #1 in 2021.\u00a0 Ford F-Series trucks retained the title of #1 truck in America for 46 straight years and the #1 selling vehicle overall for 41 straight years.\nHere are your winners and losers by brand for the full year of 2022 and how the numbers fared versus the year of 2021:\n\u00a0\n\u00a0\n\n\n\u00a0\n\nBrand\n\n\n\u00a02022 U.S. Sales\n\n\nVS 2021\n\n\n\n1.\nToyota\n1,849,751 \u00a0\nDown 9%\n\n\n2.\nFord\n1,767,439\u00a0\u00a0\nDown 2%\n\n\n3.\nChevrolet\n1,502,389\u00a0\u00a0\nUp 6%\n\n\n4.\nHonda\n881,201\u00a0\nDown 33%\n\n\n5.\nHyundai\n724,265\u00a0\nDown 2%\n\n\n6.\nKia\n693,549\u00a0\nDown 1%\n\n\n7.\nJeep\n684,612\u00a0\nDown 12%\n\n\n8.\nNissan\n682,731\u00a0\u00a0\nDown 25%\n\n\n9.\nSubaru\u00a0\n556,581\u00a0\u00a0\nDown 5%\n\n\n10.\u00a0\nRam Trucks\n545,194\u00a0\nDown 16%\n\n\n11.\nGMC\n517,649\u00a0\u00a0\nUp 7%\n\n\n12.\nMercedes-Benz\n350,949\u00a0\nUp 7%\n\n\n13.\nBMW\n332,388\u00a0\nDown 1%\n\n\n14.\nVolkswagen\n301,069\u00a0\nDown 20%\n\n\n15.\nMazda\n294,908\u00a0\nDown 11%\n\n\n16.\nLexus\n258,704\u00a0\nDown 15%\n\n\n17.\nDodge\n190,793\u00a0\u00a0\nDown 12%\n\n\n18.\nAudi\n186,875\u00a0\nDown 5%\n\n\n19.\nCadillac\n134,726\u00a0\nUp 14%\n\n\n20.\nChrysler\u00a0\n112,713\nDown 2%\n\n\n21.\nBuick\n103,519\u00a0\nDown 42%\n\n\n22.\nAcura\n102,306\u00a0\u00a0\nDown 35%\n\n\n23.\nVolvo\n102,038\u00a0\nDown 16%\n\n\n24.\nMitsubishi\n102,037 \nDown 16%\n\n\n25.\nLincoln\n83,486\u00a0\nDown 4%\n\n\n26.\nPorsche\n\n70,065\n\n\nFlat\n\n\n\n27.\nGenesis\n\n56,410\u00a0\n\n\nUp 14%\n\n\n\n28.\nINFINITI\n46,619\u00a0\nDown 20%\n\n\n29.\nMINI\n29,504\u00a0\nDown 1%\n\n\n30.\nAlfa Romeo\n12,845\u00a0\u00a0\nDown 30%\n\n\n31.\nMaserati\n\u00a06,413\u00a0\nDown 10%\n\n\n32.\nBentley\n3,975\u00a0 \u00a0 \u00a0\u00a0\nFLAT\n\n\n33.\nLamborghini\n3,134\u00a0\nUp 3%\n\n\n34.\nFiat\u00a0\n915\u00a0\u00a0\nDown 61%\n\n\n35.\nMcLaren\n\n840\u00a0\n\n\nDown 35%\n\n\n\n36.\nRolls-Royce\n460\u00a0\nUp 7%\n\n\n\n\n\u00a0\nNote: Jaguar and Land Rover have not reported 2022 sales. Also, the all-electric makes like Tesla, Lucid, Karma, and Polestar do not report sales, only how many vehicles were produced, but that is not a reflection of actual sales since we don\u2019t know how many were built, but not sold. \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\n\nPhoto Credit: Toyota.\n\n\n\n\n\n\n\nShare: \n\n\n\nFacebook\n\n\n\n\n\n\n\nTwitter\n\n\n\n\n\n\n\nLinkedIn\n\n\n\n\n\n\n\nEmail\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nJerry Reynolds\n\n\nFrom police officer to top-selling Ford dealer to on-air car expert, Jerry helms our weekly radio show. Since selling his dealerships in 2006, Jerry has pursued his top three passions: helping consumers have a great car buying experience, supporting the military and first responders, being a loyal servant to his dog! While Jerry admits to hitting the pedal to the metal on test drives, it's all the service of finding out just how fast he can go from 0 to 60.\n\n\n\n\n\nShare On Facebook\n\n\n\n\n\n\n\nShare On Twitter\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRecent Posts\n\n\n\n\n\n\n\n\n\n\nCrime Wave:\u00a0 Two Vehicles Stolen Every Minute\n\n\n\n            \n              Read Post\n            \n          \n\n\n\n\n\n\n\n\n\n\n\n\n\nSummer Road Trip Checklist For Your Car\n\n\n\n            \n              Read Post\n            \n          \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCarPro\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFollow us on Facebook\n\n\n\n\n\nFollow us on Twitter\n\n\n\n\n\n\nFollow us on Youtube\n\n\n\n\n\n\nFollow us on Instagram\n\n\n\n\n\n\n\n\nFind a CarPro Friend\n\nFind a Car\n\nRadio Show\n\nAbout Us\n\nWhy CarPro\n\n\nFAQs\n\nNews\n\nCar Reviews\n\nLaura's Auto News\n\nRadio Show Newsletter\n\n\nWebsite Help\n\nEmail the CarPro\n\nMedia Company Inquiry\n\nBecome a Radio Partner\n\nBecome a Certified CarPro\n\n\n\n\n\u00a92023 CarPro\n\n\nPrivacy Policy\nTerms Of Use\nAccessibility Statement\n\n\n\n\nCarPro requires our Certified Dealers to meet certain customer service requirements in accordance with our Certification Process and Agreement. CarPro does not broker, sell, or lease vehicles. All vehicles shown on this website are offered for sale by licensed motor vehicle dealers, unless where otherwise noted. Used vehicles are subject to prior sale. By accessing this website, you agree to the CarPro Terms of Service and Privacy Policy. We strive to update our website in a timely manner however CarPro cannot guarantee that the inventory shown will be available at the dealership.\nWe are not responsible for typographical and other errors, including data transmissions or software errors that may appear on the site. If the posted price, incentive, offer or other service is incorrect due to typographical or other error we will only be responsible for honoring the correct price, incentive or offer. We make every effort to provide you the most accurate, up-to-the-minute information however when you are ready to purchase products or services, it is your responsibility to verify with us that all details listed are accurate. Prices include all applicable rebates.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"}
{"key": "Given the following question:\n```\n2022 USA national auto sales by brand\n```\nI got the following answer from a web page:\n```\nFull-Year 2022 National Auto Sales By Brand <img src=\"https://data.adxcel-ec2.com/pixel/?ad_log=referer&amp;action=lead&amp;pixid=b719b86c-f9d4-4c28-a8a8-135a5ff2099d\" width=\"1\" height=\"1\" border=\"0\"> Search Create Account Login CarPro You have a friend. Listen Live Buy a Car Find a CarPro Friend Find a Car Sell Your Car Car Buying Resources Car Reviews FAQs News Laura's Auto News Radio Show Radio Schedule Radio Blog Dealer True Stories CarPro Radio Show Podcast Driving N Heels Podcast CarPro Radio Show Newsletter Listen Live Menu News, Auto Sales Full-Year 2022 National Auto Sales By Brand Written by Jerry Reynolds January 12, 2023 Share: Facebook Twitter LinkedIn Email It was a challenging year for the auto industry, primarily due to the microchip shortages, and certainly rising interest rates did not help. There was also a noticeable lack of incentives from the automakers, and lease deals were not nearly as good as in years past. December showed some sparks of life for many car companies, as sales rose 7.2%, but not enough to put the sales numbers over the 14 million mark, making 2022 sales the lowest since 2011. General Motors regained the #1 sales leadership spot, wrestling it away from Toyota, which was #1 in 2021. Ford F-Series trucks retained the title of #1 truck in America for 46 straight years and the #1 selling vehicle overall for 41 straight years. Here are your winners and losers by brand for the full year of 2022 and how the numbers fared versus the year of 2021: Brand 2022 U.S. Sales VS 2021 1. Toyota 1,849,751 Down 9% 2. Ford 1,767,439 Down 2% 3. Chevrolet 1,502,389 Up 6% 4. Honda 881,201 Down 33% 5. Hyundai 724,265 Down 2% 6. Kia 693,549 Down 1% 7. Jeep 684,612 Down 12% 8. Nissan 682,731 Down 25% 9. Subaru 556,581 Down 5% 10. Ram Trucks 545,194 Down 16% 11. GMC 517,649 Up 7% 12. Mercedes-Benz 350,949 Up 7% 13. BMW 332,388 Down 1% 14. Volkswagen 301,069 Down 20% 15. Mazda 294,908 Down 11% 16. Lexus 258,704 Down 15% 17. Dodge 190,793 Down 12% 18. Audi 186,875 Down 5% 19. Cadillac 134,726 Up 14% 20. Chrysler 112,713 Down 2% 21. Buick 103,519 Down 42% 22. Acura 102,306 Down 35% 23. Volvo 102,038 Down 16% 24. Mitsubishi 102,037 Down 16% 25. Lincoln 83,486 Down 4% 26. Porsche 70,065 Flat 27. Genesis 56,410 Up 14% 28. INFINITI 46,619 Down 20% 29. MINI 29,504 Down 1% 30. Alfa Romeo 12,845 Down 30% 31. Maserati 6,413 Down 10% 32. Bentley 3,975 FLAT 33. Lamborghini 3,134 Up 3% 34. Fiat 915 Down 61% 35. McLaren 840 Down 35% 36. Rolls-Royce 460 Up 7% Note: Jaguar and Land Rover have not reported 2022 sales. Also, the all-electric makes like Tesla, Lucid, Karma, and Polestar do not report sales, only how many vehicles were produced, but that is not a reflection of actual sales since we don\u2019t know how many were built, but not sold. Photo Credit: Toyota. Share: Facebook Twitter LinkedIn Email Jerry Reynolds From police officer to top-selling Ford dealer to on-air car expert, Jerry helms our weekly radio show. Since selling his dealerships in 2006, Jerry has pursued his top three passions: helping consumers have a great car buying experience, supporting the military and first responders, being a loyal servant to his dog! While Jerry admits to hitting the pedal to the metal on test drives, it's all the service of finding out just how fast he can go from 0 to 60. Share On Facebook Share On Twitter Recent Posts Crime Wave: Two Vehicles Stolen Every Minute Read Post Summer Road Trip Checklist For Your Car Read Post CarPro Follow us on Facebook Follow us on Twitter Follow us on Youtube Follow us on Instagram Find a CarPro Friend Find a Car Radio Show About Us Why CarPro FAQs News Car Reviews Laura's Auto News Radio Show Newsletter Website Help Email the CarPro Media Company Inquiry Become a Radio Partner Become a Certified CarPro \u00a92023 CarPro Privacy Policy Terms Of Use Accessibility Statement CarPro requires our Certified Dealers to meet certain customer service requirements in accordance with our Certification Process and Agreement. CarPro does not broker, sell, or lease vehicles. All vehicles shown on this website are offered for sale by licensed motor vehicle dealers, unless where otherwise noted. Used vehicles are subject to prior sale. By accessing this website, you agree to the CarPro Terms of Service and Privacy Policy. We strive to update our website in a timely manner however CarPro cannot guarantee that the inventory shown will be available at the dealership. We are not responsible for typographical and other errors, including data transmissions or software errors that may appear on the site. If the posted price, incentive, offer or other service is incorrect due to typographical or other error we will only be responsible for honoring the correct price, incentive or offer. We make every effort to provide you the most accurate, up-to-the-minute information however when you are ready to purchase products or services, it is your responsibility to verify with us that all details listed are accurate. Prices include all applicable rebates.\n```\nNow help me write a SQL query to store the answer into a temp view.\nHere is an example of how to store data into a temp view:\n```\nCREATE OR REPLACE TEMP VIEW movies AS SELECT * FROM VALUES('Citizen Kane', 1941), ('Schindler's List', 1993) AS v1(title, year)\n```\n\nThe answer MUST contain query only.\n", "value": "CREATE OR REPLACE TEMP VIEW auto_sales_2022 AS SELECT * FROM VALUES\n('Toyota', 1849751, -9),\n('Ford', 1767439, -2),\n('Chevrolet', 1502389, 6),\n('Honda', 881201, -33),\n('Hyundai', 724265, -2),\n('Kia', 693549, -1),\n('Jeep', 684612, -12),\n('Nissan', 682731, -25),\n('Subaru', 556581, -5),\n('Ram Trucks', 545194, -16),\n('GMC', 517649, 7),\n('Mercedes-Benz', 350949, 7),\n('BMW', 332388, -1),\n('Volkswagen', 301069, -20),\n('Mazda', 294908, -11),\n('Lexus', 258704, -15),\n('Dodge', 190793, -12),\n('Audi', 186875, -5),\n('Cadillac', 134726, 14),\n('Chrysler', 112713, -2),\n('Buick', 103519, -42),\n('Acura', 102306, -35),\n('Volvo', 102038, -16),\n('Mitsubishi', 102037, -16),\n('Lincoln', 83486, -4),\n('Porsche', 70065, 0),\n('Genesis', 56410, 14),\n('INFINITI', 46619, -20),\n('MINI', 29504, -1),\n('Alfa Romeo', 12845, -30),\n('Maserati', 6413, -10),\n('Bentley', 3975, 0),\n('Lamborghini', 3134, 3),\n('Fiat', 915, -61),\n('McLaren', 840, -35),\n('Rolls-Royce', 460, 7)\nAS v1(brand, us_sales, vs_2021)"}
{"key": "\nGiven 1) a PySpark dataframe, df, and 2) a description of expected properties, desc,\ngenerate a Python function to test whether the given dataframe satisfies the expected properties.\nYour generated function should take 1 parameter, df, and the return type should be a boolean.\nYou will call the function, passing in df as the parameter, and return the output (True/False).\n\nIn total, your output must follow the format below, exactly (no explanation words):\n1. function definition f, in Python\n2. 1 blank new line\n3. Call f on df and assign the result to a variable, result: result = name_of_f(df)\n\nInclude any necessary import statements INSIDE the function definition.\nFor example:\ndef gen_random():\n    import random\n    return random.randint(0, 10)\n\nFor example:\nInput:\ndf = DataFrame[name: string, age: int]\ndesc = \"expect 5 columns\"\n\nOutput:\n\"def has_5_columns(df) -> bool:\n    # Get the number of columns in the DataFrame\n    num_columns = len(df.columns)\n\n    # Check if the number of columns is equal to 5\n    if num_columns == 5:\n        return True\n    else:\n        return False\n\nresult = has_5_columns(df)\"\n\nHere is your input df: DataFrame[brand: string, us_sales: int, vs_2021: int]\nHere is your input description: expect sales change percentage to be between -100 to 100\n", "value": "def sales_change_percentage_valid(df) -> bool:\n    from pyspark.sql.functions import col\n\n    # Calculate the sales change percentage\n    df = df.withColumn(\"sales_change_percentage\", (col(\"vs_2021\") - col(\"us_sales\")) / col(\"us_sales\") * 100)\n\n    # Check if the sales change percentage is between -100 and 100\n    invalid_rows = df.filter((col(\"sales_change_percentage\") < -100) | (col(\"sales_change_percentage\") > 100)).count()\n\n    if invalid_rows == 0:\n        return True\n    else:\n        return False\n\nresult = sales_change_percentage_valid(df)"}
{"key": "You are an Apache Spark SQL expert, who can summary what a dataframe retrieves. Given an analyzed \nquery plan of a dataframe, you will \n1. convert the dataframe to SQL query. Note that an explain output contains plan \nnodes separated by `\\n`. Each plan node has its own expressions and expression ids. \n2. summary what the sql query retrieves. \n\n\n\nanalyzed_plan: \nGlobalLimit 100\n    +- LocalLimit 100\n       +- Sort [d_year ASC NULLS FIRST, sum_agg DESC NULLS LAST, brand_id ASC NULLS FIRST], true\n          +- Aggregate [d_year, i_brand, i_brand_id], [d_year, i_brand_id AS brand_id, i_brand AS brand, sum(ss_ext_sales_price) AS sum_agg]\n             +- Filter (((d_date_sk = ss_sold_date_sk) AND (ss_item_sk = i_item_sk)) AND ((i_manufact_id = 128) AND (d_moy = 11)))\n                +- Join Inner\n                   :- Join Inner\n                   :  :- SubqueryAlias dt\n                   :  :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.date_dim\n                   :  :     +- Relation spark_catalog.tpcds_sf1_delta.date_dim[d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,... 4 more fields] parquet\n                   :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.store_sales\n                   :     +- Relation spark_catalog.tpcds_sf1_delta.store_sales[ss_sold_date_sk,ss_sold_time_sk,ss_item_sk,ss_customer_sk,ss_cdemo_sk,ss_hdemo_sk,ss_addr_sk,ss_store_sk,ss_promo_sk,ss_ticket_numberL,ss_quantity,ss_wholesale_cost,ss_list_price,ss_sales_price,ss_ext_discount_amt,ss_ext_sales_price,ss_ext_wholesale_cost,ss_ext_list_price,ss_ext_tax,ss_coupon_amt,ss_net_paid,ss_net_paid_inc_tax,ss_net_profit] parquet\n                   +- SubqueryAlias spark_catalog.tpcds_sf1_delta.item\n                      +- Relation spark_catalog.tpcds_sf1_delta.item[i_item_sk,i_item_id,i_rec_start_date,i_rec_end_date,i_item_desc,i_current_price,i_wholesale_cost,i_brand_id,i_brand,i_class_id,i_class,i_category_id,i_category,i_manufact_id,i_manufact,i_size,i_formulation,i_color,i_units,i_container,i_manager_id,i_product_name] parquet\n\nexplain: \nThe analyzed plan can be translated into the following SQL query:\n```sql\nSELECT\n  dt.d_year,\n  item.i_brand_id brand_id,\n  item.i_brand brand,\n  SUM(ss_ext_sales_price) sum_agg\nFROM date_dim dt, store_sales, item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manufact_id = 128\n  AND dt.d_moy = 11\nGROUP BY dt.d_year, item.i_brand, item.i_brand_id\nORDER BY dt.d_year, sum_agg DESC, brand_id\nLIMIT 100\n```\nIn summary, this dataframe is retrieving the top 100 brands (specifically of items manufactured by manufacturer with id 128) with the highest total sales price for each year in the month of November. It presents the results sorted by year, total sales (in descending order), and brand id.\n\n\n\nanalyzed_plan: SubqueryAlias auto_sales_2022\n+- View (`auto_sales_2022`, [brand,us_sales,vs_2021])\n   +- Project [cast(brand as string) AS brand, cast(us_sales as int) AS us_sales, cast(vs_2021 as int) AS vs_2021]\n      +- Project [brand, us_sales, vs_2021]\n         +- SubqueryAlias v1\n            +- LocalRelation [brand, us_sales, vs_2021]\n\nexplain:", "value": "The analyzed plan can be translated into the following SQL query:\n```sql\nCREATE VIEW auto_sales_2022 AS\nSELECT\n  CAST(brand AS STRING) AS brand,\n  CAST(us_sales AS INT) AS us_sales,\n  CAST(vs_2021 AS INT) AS vs_2021\nFROM v1\n```\nIn summary, this dataframe is creating a view called `auto_sales_2022` with columns `brand`, `us_sales`, and `vs_2021`. The view is based on the local relation `v1` and casts the columns to their respective data types (string for brand, and int for us_sales and vs_2021)."}
{"key": "\nYou are an Apache Spark SQL expert programmer.\n\nGiven a pyspark dataframe `df`.\n\nThe output columns of `df`:\nbrand: string\nus_sales: int\nvs_2021: int\n\nAnd an explanation of `df`: The analyzed plan can be translated into the following SQL query:\n```sql\nCREATE VIEW auto_sales_2022 AS\nSELECT\n  CAST(brand AS STRING) AS brand,\n  CAST(us_sales AS INT) AS us_sales,\n  CAST(vs_2021 AS INT) AS vs_2021\nFROM v1\n```\nIn summary, this dataframe is creating a view called `auto_sales_2022` with columns `brand`, `us_sales`, and `vs_2021`. The view is based on the local relation `v1` and casts the columns to their respective data types (string for brand, and int for us_sales and vs_2021).\n\nWrite python code to visualize the result of `df` using plotly.\nYour code must NOT include the method 'append'. \nThere is no need to install any package with pip. \nDisplay the plot directly, instead of saving into an HTML.\n\nEnsure that your code is correct.\n\n", "value": "To visualize the result of `df` using Plotly, you can follow these steps:\n\n1. Convert the PySpark DataFrame to a Pandas DataFrame.\n2. Create a Plotly figure using the Pandas DataFrame.\n3. Display the plot directly.\n\nHere's the code to achieve this:\n\n```python\nimport pandas as pd\nimport plotly.express as px\n\n# Convert the PySpark DataFrame to a Pandas DataFrame\npdf = df.toPandas()\n\n# Create a Plotly figure using the Pandas DataFrame\nfig = px.bar(pdf, x='brand', y='us_sales', text='vs_2021', title='Auto Sales 2022')\n\n# Display the plot directly\nfig.show()\n```\n\nThis code will create a bar chart with the `brand` column on the x-axis, the `us_sales` column on the y-axis, and the `vs_2021` column as the text labels on each bar. The title of the chart will be \"Auto Sales 2022\"."}
{"key": "\nYou are an Apache Spark SQL expert programmer.\n\nGiven a pyspark dataframe `df`.\n\nThe output columns of `df`:\nbrand: string\nus_sales: int\nvs_2021: int\n\nAnd an explanation of `df`: The analyzed plan can be translated into the following SQL query:\n```sql\nCREATE VIEW auto_sales_2022 AS\nSELECT\n  CAST(brand AS STRING) AS brand,\n  CAST(us_sales AS INT) AS us_sales,\n  CAST(vs_2021 AS INT) AS vs_2021\nFROM v1\n```\nIn summary, this dataframe is creating a view called `auto_sales_2022` with columns `brand`, `us_sales`, and `vs_2021`. The view is based on the local relation `v1` and casts the columns to their respective data types (string for brand, and int for us_sales and vs_2021).\n\nWrite python code to visualize the result of `df` using plotly.\nYour code must NOT include the method 'append'. \nThere is no need to install any package with pip. \nDisplay the plot directly, instead of saving into an HTML.\n\nEnsure that your code is correct.\nThe purpose of the plot: pie chart for US sales market shares, show the top 5 brands and the sum of others\n", "value": "To visualize the result of `df` using Plotly, you can follow these steps:\n\n1. Import the necessary libraries\n2. Convert the PySpark DataFrame to a Pandas DataFrame\n3. Calculate the top 5 brands and the sum of others\n4. Create a pie chart using Plotly\n5. Display the plot\n\nHere's the code:\n\n```python\nimport plotly.graph_objs as go\nimport pandas as pd\n\n# Convert the PySpark DataFrame to a Pandas DataFrame\npdf = df.toPandas()\n\n# Calculate the top 5 brands and the sum of others\ntop_5_brands = pdf.nlargest(5, 'us_sales')\nother_brands_sum = pdf.loc[~pdf.index.isin(top_5_brands.index), 'us_sales'].sum()\n\n# Add the sum of others to the top 5 brands DataFrame\nother_brands_row = pd.DataFrame({'brand': ['Others'], 'us_sales': [other_brands_sum]})\ntop_5_brands_with_others = pd.concat([top_5_brands, other_brands_row], ignore_index=True)\n\n# Create a pie chart using Plotly\nfig = go.Figure(data=[go.Pie(labels=top_5_brands_with_others['brand'],\n                             values=top_5_brands_with_others['us_sales'],\n                             hole=.3)])\n\n# Customize the plot\nfig.update_layout(title='US Sales Market Shares: Top 5 Brands and Others',\n                  annotations=[dict(text='2022', x=0.5, y=0.5, font_size=20, showarrow=False)])\n\n# Display the plot\nfig.show()\n```\n\nThis code will create a pie chart showing the US sales market shares for the top 5 brands and the sum of others. The plot will be displayed directly without saving it to an HTML file."}
{"key": "\nGiven a Spark temp view `temp_view_for_transform` with the following columns:\n```\nbrand: string\nus_sales: int\nvs_2021: int\n```\nWrite a Spark SQL query to retrieve: top brand with the highest growth\nThe answer MUST contain query only.\n", "value": "SELECT brand, (vs_2021 - us_sales) AS growth\nFROM temp_view_for_transform\nORDER BY growth DESC\nLIMIT 1"}
{"key": "You are an Apache Spark SQL expert, who can summary what a dataframe retrieves. Given an analyzed \nquery plan of a dataframe, you will \n1. convert the dataframe to SQL query. Note that an explain output contains plan \nnodes separated by `\\n`. Each plan node has its own expressions and expression ids. \n2. summary what the sql query retrieves. \n\n\n\nanalyzed_plan: \nGlobalLimit 100\n    +- LocalLimit 100\n       +- Sort [d_year ASC NULLS FIRST, sum_agg DESC NULLS LAST, brand_id ASC NULLS FIRST], true\n          +- Aggregate [d_year, i_brand, i_brand_id], [d_year, i_brand_id AS brand_id, i_brand AS brand, sum(ss_ext_sales_price) AS sum_agg]\n             +- Filter (((d_date_sk = ss_sold_date_sk) AND (ss_item_sk = i_item_sk)) AND ((i_manufact_id = 128) AND (d_moy = 11)))\n                +- Join Inner\n                   :- Join Inner\n                   :  :- SubqueryAlias dt\n                   :  :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.date_dim\n                   :  :     +- Relation spark_catalog.tpcds_sf1_delta.date_dim[d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,... 4 more fields] parquet\n                   :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.store_sales\n                   :     +- Relation spark_catalog.tpcds_sf1_delta.store_sales[ss_sold_date_sk,ss_sold_time_sk,ss_item_sk,ss_customer_sk,ss_cdemo_sk,ss_hdemo_sk,ss_addr_sk,ss_store_sk,ss_promo_sk,ss_ticket_numberL,ss_quantity,ss_wholesale_cost,ss_list_price,ss_sales_price,ss_ext_discount_amt,ss_ext_sales_price,ss_ext_wholesale_cost,ss_ext_list_price,ss_ext_tax,ss_coupon_amt,ss_net_paid,ss_net_paid_inc_tax,ss_net_profit] parquet\n                   +- SubqueryAlias spark_catalog.tpcds_sf1_delta.item\n                      +- Relation spark_catalog.tpcds_sf1_delta.item[i_item_sk,i_item_id,i_rec_start_date,i_rec_end_date,i_item_desc,i_current_price,i_wholesale_cost,i_brand_id,i_brand,i_class_id,i_class,i_category_id,i_category,i_manufact_id,i_manufact,i_size,i_formulation,i_color,i_units,i_container,i_manager_id,i_product_name] parquet\n\nexplain: \nThe analyzed plan can be translated into the following SQL query:\n```sql\nSELECT\n  dt.d_year,\n  item.i_brand_id brand_id,\n  item.i_brand brand,\n  SUM(ss_ext_sales_price) sum_agg\nFROM date_dim dt, store_sales, item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manufact_id = 128\n  AND dt.d_moy = 11\nGROUP BY dt.d_year, item.i_brand, item.i_brand_id\nORDER BY dt.d_year, sum_agg DESC, brand_id\nLIMIT 100\n```\nIn summary, this dataframe is retrieving the top 100 brands (specifically of items manufactured by manufacturer with id 128) with the highest total sales price for each year in the month of November. It presents the results sorted by year, total sales (in descending order), and brand id.\n\n\n\nanalyzed_plan: GlobalLimit 1\n+- LocalLimit 1\n   +- Sort [growth DESC NULLS LAST], true\n      +- Project [brand, (vs_2021 - us_sales) AS growth]\n         +- SubqueryAlias temp_view_for_transform\n            +- View (`temp_view_for_transform`, [brand,us_sales,vs_2021])\n               +- SubqueryAlias auto_sales_2022\n                  +- View (`auto_sales_2022`, [brand,us_sales,vs_2021])\n                     +- Project [cast(brand as string) AS brand, cast(us_sales as int) AS us_sales, cast(vs_2021 as int) AS vs_2021]\n                        +- Project [brand, us_sales, vs_2021]\n                           +- SubqueryAlias v1\n                              +- LocalRelation [brand, us_sales, vs_2021]\n\nexplain:", "value": "The analyzed plan can be translated into the following SQL query:\n```sql\nSELECT\n  brand,\n  (vs_2021 - us_sales) AS growth\nFROM (\n  SELECT\n    CAST(brand AS STRING) AS brand,\n    CAST(us_sales AS INT) AS us_sales,\n    CAST(vs_2021 AS INT) AS vs_2021\n  FROM auto_sales_2022\n) temp_view_for_transform\nORDER BY growth DESC\nLIMIT 1\n```\nIn summary, this dataframe is retrieving the brand with the highest growth in sales between 2021 and 2022. The growth is calculated as the difference between the sales in 2022 (vs_2021) and the sales in 2021 (us_sales)."}
{"key": "web_search:USA presidents", "value": "[{'title': 'Presidents | The White House', 'link': 'https://www.whitehouse.gov/about-the-white-house/presidents/', 'snippet': 'Presidents ; George Washington. The 1st President of the United States ; John Adams. The 2nd President of the United States ; Thomas Jefferson. The 3rd President\\xa0...'}, {'title': 'Chronological List of Presidents, First Ladies, and Vice Presidents of ...', 'link': 'https://www.loc.gov/rr/print/list/057_chron.html', 'snippet': 'Illustrations from the holdings of the Library of Congress Prints and Photographs Division on the subject of U.S. Presidents, First Ladies, and Vice\\xa0...'}, {'title': 'The White House', 'link': 'https://www.whitehouse.gov/', 'snippet': 'About The White House. Portrait of George Washington, the 1st President of the United States Past Presidents JFK and his family in\\xa0...'}, {'title': 'List of presidents of the United States - Wikipedia', 'link': 'https://en.wikipedia.org/wiki/List_of_presidents_of_the_United_States', 'snippet': 'The incumbent president is Joe Biden. The White House, official residence of the president of the United States, May 2006.'}, {'title': 'Presidents of the United States: Resource Guides (Virtual Programs ...', 'link': 'https://www.loc.gov/rr/program/bib/presidents/', 'snippet': 'List of U.S. Presidents \u00b7 1. George Washington \u00b7 2. John Adams \u00b7 3. Thomas Jefferson \u00b7 4. James Madison \u00b7 5. James Monroe \u00b7 6. John Quincy Adams \u00b7 7. Andrew Jackson \u00b7 8\\xa0...'}, {'title': 'Presidential election process | USAGov', 'link': 'https://www.usa.gov/election', 'snippet': 'Learn about the presidential election process, including the Electoral College, ... Learn the steps that result in the election of a U.S. president.'}, {'title': 'U.S. Presidents | Miller Center', 'link': 'https://millercenter.org/president', 'snippet': 'U.S. Presidents ; George Washington. 1 \u00b7 1789. 1797 ; John Adams. 2 \u00b7 1797. 1801 ; Thomas Jefferson. 3 \u00b7 1801. 1809 ; James Madison. 4 \u00b7 1809. 1817 ; James Monroe. 5.'}, {'title': 'Presidents, vice presidents, and first ladies | USAGov', 'link': 'https://www.usa.gov/presidents', 'snippet': 'Apr 20, 2023 ... Learn about the duties of the U.S. president, vice president, and first lady. Find out how to contact and learn more about current and past\\xa0...'}, {'title': 'About the Vice President (President of the Senate) - U.S. Senate', 'link': 'https://www.senate.gov/about/officers-staff/vice-president.htm', 'snippet': 'The Constitution names the vice president of the United States as the ... Since the 1830s, vice presidents have occupied offices near the Senate Chamber.'}, {'title': 'President', 'link': 'https://history.house.gov/Institution/Presidents-Coinciding/Presidents-Coinciding/'}]"}
{"key": "Given a Query and a list of Google Search Results, return the link\nfrom a reputable website which contains the data set to answer the question. {'The best search results should contain as many as possible of these info: president,vice_president'}\nQuery:USA presidents\nGoogle Search Results: \n```\n[{'title': 'Presidents | The White House', 'link': 'https://www.whitehouse.gov/about-the-white-house/presidents/', 'snippet': 'Presidents ; George Washington. The 1st President of the United States ; John Adams. The 2nd President of the United States ; Thomas Jefferson. The 3rd President\\xa0...'}, {'title': 'Chronological List of Presidents, First Ladies, and Vice Presidents of ...', 'link': 'https://www.loc.gov/rr/print/list/057_chron.html', 'snippet': 'Illustrations from the holdings of the Library of Congress Prints and Photographs Division on the subject of U.S. Presidents, First Ladies, and Vice\\xa0...'}, {'title': 'The White House', 'link': 'https://www.whitehouse.gov/', 'snippet': 'About The White House. Portrait of George Washington, the 1st President of the United States Past Presidents JFK and his family in\\xa0...'}, {'title': 'List of presidents of the United States - Wikipedia', 'link': 'https://en.wikipedia.org/wiki/List_of_presidents_of_the_United_States', 'snippet': 'The incumbent president is Joe Biden. The White House, official residence of the president of the United States, May 2006.'}, {'title': 'Presidents of the United States: Resource Guides (Virtual Programs ...', 'link': 'https://www.loc.gov/rr/program/bib/presidents/', 'snippet': 'List of U.S. Presidents \u00b7 1. George Washington \u00b7 2. John Adams \u00b7 3. Thomas Jefferson \u00b7 4. James Madison \u00b7 5. James Monroe \u00b7 6. John Quincy Adams \u00b7 7. Andrew Jackson \u00b7 8\\xa0...'}, {'title': 'Presidential election process | USAGov', 'link': 'https://www.usa.gov/election', 'snippet': 'Learn about the presidential election process, including the Electoral College, ... Learn the steps that result in the election of a U.S. president.'}, {'title': 'U.S. Presidents | Miller Center', 'link': 'https://millercenter.org/president', 'snippet': 'U.S. Presidents ; George Washington. 1 \u00b7 1789. 1797 ; John Adams. 2 \u00b7 1797. 1801 ; Thomas Jefferson. 3 \u00b7 1801. 1809 ; James Madison. 4 \u00b7 1809. 1817 ; James Monroe. 5.'}, {'title': 'Presidents, vice presidents, and first ladies | USAGov', 'link': 'https://www.usa.gov/presidents', 'snippet': 'Apr 20, 2023 ... Learn about the duties of the U.S. president, vice president, and first lady. Find out how to contact and learn more about current and past\\xa0...'}, {'title': 'About the Vice President (President of the Senate) - U.S. Senate', 'link': 'https://www.senate.gov/about/officers-staff/vice-president.htm', 'snippet': 'The Constitution names the vice president of the United States as the ... Since the 1830s, vice presidents have occupied offices near the Senate Chamber.'}, {'title': 'President', 'link': 'https://history.house.gov/Institution/Presidents-Coinciding/Presidents-Coinciding/'}]\n```\nThe answer MUST contain the url link only\n", "value": "https://www.loc.gov/rr/print/list/057_chron.html"}
{"key": "https://www.loc.gov/rr/print/list/057_chron.html", "value": "\n\n\n\nChronological List of Presidents, First Ladies, and Vice Presidents of the United States - Guides, Reference Aids, and Finding Aids (Prints andPhotographs Reading Room, Library of Congress)\n\n\n\n\n\n\n\n\n\n\n\n \u00a0The\n        Library of Congress >> Researchers\n\n\n\n\n\n\n\n\n\n\n\n\u00a0 Home >> \nImage Lists >> Presidents\n\n\n\n\n\nFind\n\n\n\n\nin\n\n\n\nImage Lists\nPrints\n                      and Photographs Pages\nResearchers\n                      Web Pages\nAll Library\n                      of Congress Pages\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n \nChronological List of Presidents, First Ladies, and Vice Presidents of the United States\nSelected Images From the Collections of the Library of Congress\nPrints and Photographs Division, Library of\n              Congress, Washington, D.C., 20540-4730\n\n\nThis chronological list contains entries for each president with his corresponding first lady and vice president. Note: Multiple entries appear for a president whenever there was a change in the office of vice president.\n\n\n\n\nYEAR\nPRESIDENT\nFIRST LADY\nVICE PRESIDENT\n\n\n1789-1797\nGeorge Washington\nMartha Washington\nJohn Adams\n\n\n1797-1801\nJohn Adams\nAbigail Adams\nThomas Jefferson\n\n\n1801-1805\nThomas Jefferson\n[Martha Wayles Skelton Jefferson \n    died before Jefferson assumed office;\nno image of her in P&P collections]\nAaron Burr\n\n\n1805-1809\nThomas Jefferson\nsee above\nGeorge Clinton\n\n\n1809-1812\nJames Madison\nDolley Madison\nGeorge Clinton\n\n\n1812-1813\nJames Madison\nDolley Madison\noffice vacant\n\n\n1813-1814\nJames Madison\nDolley Madison\nElbridge Gerry\n\n\n1814-1817\nJames Madison\nDolley Madison\noffice vacant\n\n\n1817-1825\nJames Monroe\nElizabeth Kortright Monroe\n   (no image)\nDaniel D. Tompkins\n\n\n1825-1829\nJohn Quincy Adams\nLouisa Catherine Adams\nJohn C. Calhoun\n\n\n1829-1832\nAndrew Jackson\nRachel Jackson [Rachel Donelson Jackson \ndied before Jackson assumed office and did not serve as first lady]\nJohn C. Calhoun\n\n\n1833-1837\nAndrew Jackson\nRachel Jackson [Rachel Donelson Jackson \ndied before Jackson assumed office and did not serve as first lady]\nMartin Van Buren\n\n\n1837-1841\nMartin Van Buren\nHannah Hoes Van Buren\nRichard M. Johnson\n\n\n1841\nWilliam Henry Harrison\nAnna Tuthill Symmes Harrison\nJohn Tyler\n\n\n1841-1845\nJohn Tyler\nLetitia Christian Tyler and Julia Gardiner Tyler (no images)\noffice vacant\n\n\n1845-1849\nJames K. Polk\nSarah Childress Polk\nGeorge M. Dallas\n\n\n1849-1850\nZachary Taylor\nMargaret Mackall Smith Taylor\n   (no image)\nMillard Fillmore\n\n\n1850-1853\nMillard Fillmore\nAbigail Powers Fillmore\noffice vacant\n\n\n1853\nFranklin Pierce\nJane M. Pierce\nWilliam R. King\n\n\n1853-1857\nFranklin Pierce\nJane M. Pierce\noffice vacant\n\n\n1857-1861\nJames Buchanan\n(never married)\nJohn C. Breckinridge\n\n\n1861-1865\nAbraham Lincoln\nMary Todd Lincoln\nHannibal Hamlin\n\n\n1865\nAbraham Lincoln\nMary Todd Lincoln\nAndrew Johnson\n\n\n1865-1869\nAndrew Johnson\nEliza McCardle Johnson\noffice vacant\n\n\n1869-1873\nUlysses S. Grant\nJulia Dent Grant\nSchuyler Colfax\n\n\n1873-1875\nUlysses S. Grant\nJulia Dent Grant\nHenry Wilson\n\n\n1875-1877\nUlysses S. Grant\nJulia Dent Grant\noffice vacant\n\n\n1877-1881\nRutherford Birchard Hayes\nLucy Webb Hayes\nWilliam A. Wheeler\n\n\n1881\nJames A. Garfield\nLucretia Rudolph Garfield\nChester A. Arthur\n\n\n1881-1885\nChester A. Arthur\nEllen Lewis Herndon Arthur\noffice vacant\n\n\n1885\nGrover Cleveland\nFrances Folsom Cleveland\nThomas A. Hendricks\n\n\n1885-1889\nGrover Cleveland\nFrances Folsom Cleveland\noffice vacant\n\n\n1889-1893\nBenjamin Harrison\nCaroline Lavinia Scott Harrison\nMary Lord Harrison\n   [Harrison's second wife,\n    but never a first lady]\nLevi P. Morton\n\n\n1893-1897\nGrover Cleveland\nFrances Folsom Cleveland\nAdlai E. Stevenson\n\n\n1897-1899\nWilliam McKinley\nIda Saxton McKinley\nGarret A. Hobart\n\n\n1899-1901\nWilliam McKinley\nIda Saxton McKinley\noffice vacant\n\n\n1901\nWilliam McKinley\nIda Saxton McKinley\nTheodore Roosevelt\n\n\n1901-1905\nTheodore Roosevelt\nEdith Kermit Carow Roosevelt\noffice vacant\n\n\n1905-1909\nTheodore Roosevelt\nEdith Kermit Carow Roosevelt\nCharles W. Fairbanks\n\n\n1909-1912\nWilliam H. Taft\nHelen Herron Taft\nJames S. Sherman\n\n\n1912-1913\nWilliam H. Taft\nHelen Herron Taft\noffice vacant\n\n\n1913-1921\nWoodrow Wilson\nEllen Axson Wilson and \nEdith\n      Bolling Galt Wilson\nThomas R. Marshall\n\n\n1921-1923\nWarren G. Harding\nFlorence Kling Harding\nCalvin Coolidge\n\n\n1923-1925\nCalvin Coolidge\nGrace Goodhue Coolidge\noffice vacant\n\n\n1925-1929\nCalvin Coolidge\nGrace Goodhue Coolidge\nCharles G. Dawes\n\n\n1929-1933\nHerbert Hoover\nLou Henry Hoover\nCharles Curtis\n\n\n1933-1941\nFranklin D. Roosevelt\nEleanor Roosevelt\nJohn N. Garner\n\n\n1941-1945\nFranklin D. Roosevelt\nEleanor Roosevelt\nHenry A. Wallace\n\n\n1945\nFranklin D. Roosevelt\nEleanor Roosevelt\nHarry S. Truman\n\n\n1945-1949\nHarry S. Truman\nBess Wallace Truman\noffice vacant\n\n\n1949-1953\nHarry S. Truman\nBess Wallace Truman\nBarkley, Alben W.\n\n\n1953-1961\nDwight D. Eisenhower\nMamie Doud Eisenhower\nRichard M. Nixon\n\n\n1961-1963\nJohn F. Kennedy\nJacqueline Kennedy\nLyndon B. Johnson\n\n\n1963-1965\nLyndon B. Johnson\nLady Bird Johnson\noffice vacant\n\n\n1965-1969\nLyndon B. Johnson\nLady Bird Johnson\nHubert H. Humphrey\n\n\n1969-1973\nRichard M. Nixon\nPat Nixon\nSpiro T. Agnew\n\n\n1973-1974\nRichard M. Nixon\nPat Nixon\nGerald R. Ford\n\n\n1974-1977\nGerald R. Ford\nBetty Ford\nNelson Rockefeller\n\n\n1977-1981\nJimmy Carter\nRosalynn Carter\nWalter F. Mondale\n\n\n1981-1989\nRonald Reagan\nNancy Reagan\nGeorge Bush\n\n\n1989-1993\nGeorge Bush\nBarbara Bush\nDan Quayle\n\n\n1993-2001\nBill Clinton\nHillary Rodham Clinton\nAlbert Gore\n\n\n2001-2009\nGeorge W. Bush\nLaura Bush\nRichard Cheney\n\n\n2009-2017\nBarack Obama\nMichelle Obama\nJoseph R. Biden\n\n\n2017-2021\nDonald J. Trump\nMelania Trump\nMike Pence\n\n\n2021-\nJoseph R. Biden\nJill Biden\nKamala Harris\n\n\n\n\n\n\nPresidents: Introduction (Rights/Ordering\n      Info.) | Adams\n        - Cleveland | Clinton - Harding \nHarrison\n        - Jefferson | Johnson - McKinley | Monroe\n          - Roosevelt | Taft - Trump | Tyler\n            - Wilson\nList of names, Alphabetically | List\n        of names, Chronologically\n\n\n\n\n\nFirst Ladies: Introduction\n      (Rights/Ordering Info.) | Adams\n        - Coolidge | Eisenhower - Hoover\nJackson\n            - Pierce |  Polk - Wilson | List\n              of names, Alphabetically\n\n\n\n\n\n\n Vice Presidents: Introduction (Rights/Ordering Info.) | Adams - Coolidge | Curtis - Hobart \nHumphrey - Rockefeller | Roosevelt - Wilson\nList of names, Alphabetically | List of names, Chronologically\n\n\n\n\n\n Top\n              of Page \n\n\n\n\n\n\n\n\n\n\n\n \u00a0 Home >> \nImage Lists >> Presidents\n\n\n\n\n\nFind\n\n\n\nin\n\n\nImage Lists\nPrints and Photographs Pages\nResearchers\n                Web Pages\nAll Library of Congress Pages\n\n\n\n\n\n\n\n\n\n\n\n\n\u00a0 The\n          Library of Congress >> Researchers\n\u00a0\n            December 21, 2020\n\nLegal | External Link Disclaimer\n\nContact\n          Us: \u00a0\nAsk\n            a Librarian\u00a0\u00a0\n\n\n\n\n\n\n\n"}
{"key": "Given the following question:\n```\nUSA presidents\n```\nI got the following answer from a web page:\n```\nChronological List of Presidents, First Ladies, and Vice Presidents of the United States - Guides, Reference Aids, and Finding Aids (Prints andPhotographs Reading Room, Library of Congress) The Library of Congress >> Researchers Home >> Image Lists >> Presidents Find in Image Lists Prints and Photographs Pages Researchers Web Pages All Library of Congress Pages Chronological List of Presidents, First Ladies, and Vice Presidents of the United States Selected Images From the Collections of the Library of Congress Prints and Photographs Division, Library of Congress, Washington, D.C., 20540-4730 This chronological list contains entries for each president with his corresponding first lady and vice president. Note: Multiple entries appear for a president whenever there was a change in the office of vice president. YEAR PRESIDENT FIRST LADY VICE PRESIDENT 1789-1797 George Washington Martha Washington John Adams 1797-1801 John Adams Abigail Adams Thomas Jefferson 1801-1805 Thomas Jefferson [Martha Wayles Skelton Jefferson died before Jefferson assumed office; no image of her in P&P collections] Aaron Burr 1805-1809 Thomas Jefferson see above George Clinton 1809-1812 James Madison Dolley Madison George Clinton 1812-1813 James Madison Dolley Madison office vacant 1813-1814 James Madison Dolley Madison Elbridge Gerry 1814-1817 James Madison Dolley Madison office vacant 1817-1825 James Monroe Elizabeth Kortright Monroe (no image) Daniel D. Tompkins 1825-1829 John Quincy Adams Louisa Catherine Adams John C. Calhoun 1829-1832 Andrew Jackson Rachel Jackson [Rachel Donelson Jackson died before Jackson assumed office and did not serve as first lady] John C. Calhoun 1833-1837 Andrew Jackson Rachel Jackson [Rachel Donelson Jackson died before Jackson assumed office and did not serve as first lady] Martin Van Buren 1837-1841 Martin Van Buren Hannah Hoes Van Buren Richard M. Johnson 1841 William Henry Harrison Anna Tuthill Symmes Harrison John Tyler 1841-1845 John Tyler Letitia Christian Tyler and Julia Gardiner Tyler (no images) office vacant 1845-1849 James K. Polk Sarah Childress Polk George M. Dallas 1849-1850 Zachary Taylor Margaret Mackall Smith Taylor (no image) Millard Fillmore 1850-1853 Millard Fillmore Abigail Powers Fillmore office vacant 1853 Franklin Pierce Jane M. Pierce William R. King 1853-1857 Franklin Pierce Jane M. Pierce office vacant 1857-1861 James Buchanan (never married) John C. Breckinridge 1861-1865 Abraham Lincoln Mary Todd Lincoln Hannibal Hamlin 1865 Abraham Lincoln Mary Todd Lincoln Andrew Johnson 1865-1869 Andrew Johnson Eliza McCardle Johnson office vacant 1869-1873 Ulysses S. Grant Julia Dent Grant Schuyler Colfax 1873-1875 Ulysses S. Grant Julia Dent Grant Henry Wilson 1875-1877 Ulysses S. Grant Julia Dent Grant office vacant 1877-1881 Rutherford Birchard Hayes Lucy Webb Hayes William A. Wheeler 1881 James A. Garfield Lucretia Rudolph Garfield Chester A. Arthur 1881-1885 Chester A. Arthur Ellen Lewis Herndon Arthur office vacant 1885 Grover Cleveland Frances Folsom Cleveland Thomas A. Hendricks 1885-1889 Grover Cleveland Frances Folsom Cleveland office vacant 1889-1893 Benjamin Harrison Caroline Lavinia Scott Harrison Mary Lord Harrison [Harrison's second wife, but never a first lady] Levi P. Morton 1893-1897 Grover Cleveland Frances Folsom Cleveland Adlai E. Stevenson 1897-1899 William McKinley Ida Saxton McKinley Garret A. Hobart 1899-1901 William McKinley Ida Saxton McKinley office vacant 1901 William McKinley Ida Saxton McKinley Theodore Roosevelt 1901-1905 Theodore Roosevelt Edith Kermit Carow Roosevelt office vacant 1905-1909 Theodore Roosevelt Edith Kermit Carow Roosevelt Charles W. Fairbanks 1909-1912 William H. Taft Helen Herron Taft James S. Sherman 1912-1913 William H. Taft Helen Herron Taft office vacant 1913-1921 Woodrow Wilson Ellen Axson Wilson and Edith Bolling Galt Wilson Thomas R. Marshall 1921-1923 Warren G. Harding Florence Kling Harding Calvin Coolidge 1923-1925 Calvin Coolidge Grace Goodhue Coolidge office vacant 1925-1929 Calvin Coolidge Grace Goodhue Coolidge Charles G. Dawes 1929-1933 Herbert Hoover Lou Henry Hoover Charles Curtis 1933-1941 Franklin D. Roosevelt Eleanor Roosevelt John N. Garner 1941-1945 Franklin D. Roosevelt Eleanor Roosevelt Henry A. Wallace 1945 Franklin D. Roosevelt Eleanor Roosevelt Harry S. Truman 1945-1949 Harry S. Truman Bess Wallace Truman office vacant 1949-1953 Harry S. Truman Bess Wallace Truman Barkley, Alben W. 1953-1961 Dwight D. Eisenhower Mamie Doud Eisenhower Richard M. Nixon 1961-1963 John F. Kennedy Jacqueline Kennedy Lyndon B. Johnson 1963-1965 Lyndon B. Johnson Lady Bird Johnson office vacant 1965-1969 Lyndon B. Johnson Lady Bird Johnson Hubert H. Humphrey 1969-1973 Richard M. Nixon Pat Nixon Spiro T. Agnew 1973-1974 Richard M. Nixon Pat Nixon Gerald R. Ford 1974-1977 Gerald R. Ford Betty Ford Nelson Rockefeller 1977-1981 Jimmy Carter Rosalynn Carter Walter F. Mondale 1981-1989 Ronald Reagan Nancy Reagan George Bush 1989-1993 George Bush Barbara Bush Dan Quayle 1993-2001 Bill Clinton Hillary Rodham Clinton Albert Gore 2001-2009 George W. Bush Laura Bush Richard Cheney 2009-2017 Barack Obama Michelle Obama Joseph R. Biden 2017-2021 Donald J. Trump Melania Trump Mike Pence 2021- Joseph R. Biden Jill Biden Kamala Harris Presidents: Introduction (Rights/Ordering Info.) | Adams - Cleveland | Clinton - Harding Harrison - Jefferson | Johnson - McKinley | Monroe - Roosevelt | Taft - Trump | Tyler - Wilson List of names, Alphabetically | List of names, Chronologically First Ladies: Introduction (Rights/Ordering Info.) | Adams - Coolidge | Eisenhower - Hoover Jackson - Pierce | Polk - Wilson | List of names, Alphabetically Vice Presidents: Introduction (Rights/Ordering Info.) | Adams - Coolidge | Curtis - Hobart Humphrey - Rockefeller | Roosevelt - Wilson List of names, Alphabetically | List of names, Chronologically Top of Page Home >> Image Lists >> Presidents Find in Image Lists Prints and Photographs Pages Researchers Web Pages All Library of Congress Pages The Library of Congress >> Researchers December 21, 2020 Legal | External Link Disclaimer Contact Us: Ask a Librarian\n```\nNow help me write a SQL query to store the answer into a temp view.\nHere is an example of how to store data into a temp view:\n```\nCREATE OR REPLACE TEMP VIEW movies AS SELECT * FROM VALUES('Citizen Kane', 1941), ('Schindler's List', 1993) AS v1(title, year)\n```\nThe result view MUST contain following columns: ['president', 'vice_president']\nThe answer MUST contain query only.\n", "value": "CREATE OR REPLACE TEMP VIEW usa_presidents AS SELECT * FROM VALUES\n('George Washington', 'John Adams'),\n('John Adams', 'Thomas Jefferson'),\n('Thomas Jefferson', 'Aaron Burr'),\n('Thomas Jefferson', 'George Clinton'),\n('James Madison', 'George Clinton'),\n('James Madison', 'Elbridge Gerry'),\n('James Monroe', 'Daniel D. Tompkins'),\n('John Quincy Adams', 'John C. Calhoun'),\n('Andrew Jackson', 'John C. Calhoun'),\n('Andrew Jackson', 'Martin Van Buren'),\n('Martin Van Buren', 'Richard M. Johnson'),\n('William Henry Harrison', 'John Tyler'),\n('John Tyler', 'office vacant'),\n('James K. Polk', 'George M. Dallas'),\n('Zachary Taylor', 'Millard Fillmore'),\n('Millard Fillmore', 'office vacant'),\n('Franklin Pierce', 'William R. King'),\n('Franklin Pierce', 'office vacant'),\n('James Buchanan', 'John C. Breckinridge'),\n('Abraham Lincoln', 'Hannibal Hamlin'),\n('Abraham Lincoln', 'Andrew Johnson'),\n('Andrew Johnson', 'office vacant'),\n('Ulysses S. Grant', 'Schuyler Colfax'),\n('Ulysses S. Grant', 'Henry Wilson'),\n('Ulysses S. Grant', 'office vacant'),\n('Rutherford Birchard Hayes', 'William A. Wheeler'),\n('James A. Garfield', 'Chester A. Arthur'),\n('Chester A. Arthur', 'office vacant'),\n('Grover Cleveland', 'Thomas A. Hendricks'),\n('Grover Cleveland', 'office vacant'),\n('Benjamin Harrison', 'Levi P. Morton'),\n('Grover Cleveland', 'Adlai E. Stevenson'),\n('William McKinley', 'Garret A. Hobart'),\n('William McKinley', 'office vacant'),\n('William McKinley', 'Theodore Roosevelt'),\n('Theodore Roosevelt', 'office vacant'),\n('Theodore Roosevelt', 'Charles W. Fairbanks'),\n('William H. Taft', 'James S. Sherman'),\n('William H. Taft', 'office vacant'),\n('Woodrow Wilson', 'Thomas R. Marshall'),\n('Warren G. Harding', 'Calvin Coolidge'),\n('Calvin Coolidge', 'office vacant'),\n('Calvin Coolidge', 'Charles G. Dawes'),\n('Herbert Hoover', 'Charles Curtis'),\n('Franklin D. Roosevelt', 'John N. Garner'),\n('Franklin D. Roosevelt', 'Henry A. Wallace'),\n('Franklin D. Roosevelt', 'Harry S. Truman'),\n('Harry S. Truman', 'office vacant'),\n('Harry S. Truman', 'Alben W. Barkley'),\n('Dwight D. Eisenhower', 'Richard M. Nixon'),\n('John F. Kennedy', 'Lyndon B. Johnson'),\n('Lyndon B. Johnson', 'office vacant'),\n('Lyndon B. Johnson', 'Hubert H. Humphrey'),\n('Richard M. Nixon', 'Spiro T. Agnew'),\n('Richard M. Nixon', 'Gerald R. Ford'),\n('Gerald R. Ford', 'Nelson Rockefeller'),\n('Jimmy Carter', 'Walter F. Mondale'),\n('Ronald Reagan', 'George Bush'),\n('George Bush', 'Dan Quayle'),\n('Bill Clinton', 'Albert Gore'),\n('George W. Bush', 'Richard Cheney'),\n('Barack Obama', 'Joseph R. Biden'),\n('Donald J. Trump', 'Mike Pence'),\n('Joseph R. Biden', 'Kamala Harris')\nAS v1(president, vice_president)"}
{"key": "\nGiven a Spark temp view `temp_view_for_transform` with the following columns:\n```\npresident: string\nvice_president: string\n```\nWrite a Spark SQL query to retrieve: presidents who were also vice presidents\nThe answer MUST contain query only.\n", "value": "SELECT DISTINCT president\nFROM temp_view_for_transform\nWHERE president IN (SELECT vice_president FROM temp_view_for_transform)"}
{"key": "You are an Apache Spark SQL expert, who can summary what a dataframe retrieves. Given an analyzed \nquery plan of a dataframe, you will \n1. convert the dataframe to SQL query. Note that an explain output contains plan \nnodes separated by `\\n`. Each plan node has its own expressions and expression ids. \n2. summary what the sql query retrieves. \n\n\n\nanalyzed_plan: \nGlobalLimit 100\n    +- LocalLimit 100\n       +- Sort [d_year ASC NULLS FIRST, sum_agg DESC NULLS LAST, brand_id ASC NULLS FIRST], true\n          +- Aggregate [d_year, i_brand, i_brand_id], [d_year, i_brand_id AS brand_id, i_brand AS brand, sum(ss_ext_sales_price) AS sum_agg]\n             +- Filter (((d_date_sk = ss_sold_date_sk) AND (ss_item_sk = i_item_sk)) AND ((i_manufact_id = 128) AND (d_moy = 11)))\n                +- Join Inner\n                   :- Join Inner\n                   :  :- SubqueryAlias dt\n                   :  :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.date_dim\n                   :  :     +- Relation spark_catalog.tpcds_sf1_delta.date_dim[d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,... 4 more fields] parquet\n                   :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.store_sales\n                   :     +- Relation spark_catalog.tpcds_sf1_delta.store_sales[ss_sold_date_sk,ss_sold_time_sk,ss_item_sk,ss_customer_sk,ss_cdemo_sk,ss_hdemo_sk,ss_addr_sk,ss_store_sk,ss_promo_sk,ss_ticket_numberL,ss_quantity,ss_wholesale_cost,ss_list_price,ss_sales_price,ss_ext_discount_amt,ss_ext_sales_price,ss_ext_wholesale_cost,ss_ext_list_price,ss_ext_tax,ss_coupon_amt,ss_net_paid,ss_net_paid_inc_tax,ss_net_profit] parquet\n                   +- SubqueryAlias spark_catalog.tpcds_sf1_delta.item\n                      +- Relation spark_catalog.tpcds_sf1_delta.item[i_item_sk,i_item_id,i_rec_start_date,i_rec_end_date,i_item_desc,i_current_price,i_wholesale_cost,i_brand_id,i_brand,i_class_id,i_class,i_category_id,i_category,i_manufact_id,i_manufact,i_size,i_formulation,i_color,i_units,i_container,i_manager_id,i_product_name] parquet\n\nexplain: \nThe analyzed plan can be translated into the following SQL query:\n```sql\nSELECT\n  dt.d_year,\n  item.i_brand_id brand_id,\n  item.i_brand brand,\n  SUM(ss_ext_sales_price) sum_agg\nFROM date_dim dt, store_sales, item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manufact_id = 128\n  AND dt.d_moy = 11\nGROUP BY dt.d_year, item.i_brand, item.i_brand_id\nORDER BY dt.d_year, sum_agg DESC, brand_id\nLIMIT 100\n```\nIn summary, this dataframe is retrieving the top 100 brands (specifically of items manufactured by manufacturer with id 128) with the highest total sales price for each year in the month of November. It presents the results sorted by year, total sales (in descending order), and brand id.\n\n\n\nanalyzed_plan: Distinct\n+- Project [president]\n   +- Filter president IN (list [])\n      :  +- Project [vice_president]\n      :     +- SubqueryAlias temp_view_for_transform\n      :        +- View (`temp_view_for_transform`, [president,vice_president])\n      :           +- SubqueryAlias usa_presidents\n      :              +- View (`usa_presidents`, [president,vice_president])\n      :                 +- Project [cast(president as string) AS president, cast(vice_president as string) AS vice_president]\n      :                    +- Project [president, vice_president]\n      :                       +- SubqueryAlias v1\n      :                          +- LocalRelation [president, vice_president]\n      +- SubqueryAlias temp_view_for_transform\n         +- View (`temp_view_for_transform`, [president,vice_president])\n            +- SubqueryAlias usa_presidents\n               +- View (`usa_presidents`, [president,vice_president])\n                  +- Project [cast(president as string) AS president, cast(vice_president as string) AS vice_president]\n                     +- Project [president, vice_president]\n                        +- SubqueryAlias v1\n                           +- LocalRelation [president, vice_president]\n\nexplain:", "value": "The analyzed plan can be translated into the following SQL query:\n```sql\nSELECT DISTINCT president\nFROM usa_presidents\nWHERE president NOT IN (\n  SELECT vice_president\n  FROM usa_presidents\n)\n```\nIn summary, this dataframe is retrieving the list of presidents who have never been vice-presidents from the `usa_presidents` table."}
{"key": "\nGiven 1) a PySpark dataframe, df, and 2) a description of expected properties, desc,\ngenerate a Python function to test whether the given dataframe satisfies the expected properties.\nYour generated function should take 1 parameter, df, and the return type should be a boolean.\nYou will call the function, passing in df as the parameter, and return the output (True/False).\n\nIn total, your output must follow the format below, exactly (no explanation words):\n1. function definition f, in Python\n2. 1 blank new line\n3. Call f on df and assign the result to a variable, result: result = name_of_f(df)\n\nInclude any necessary import statements INSIDE the function definition.\nFor example:\ndef gen_random():\n    import random\n    return random.randint(0, 10)\n\nFor example:\nInput:\ndf = DataFrame[name: string, age: int]\ndesc = \"expect 5 columns\"\n\nOutput:\n\"def has_5_columns(df) -> bool:\n    # Get the number of columns in the DataFrame\n    num_columns = len(df.columns)\n\n    # Check if the number of columns is equal to 5\n    if num_columns == 5:\n        return True\n    else:\n        return False\n\nresult = has_5_columns(df)\"\n\nHere is your input df: DataFrame[president: string]\nHere is your input description: expect no NULL values\n", "value": "def no_null_values(df) -> bool:\n    from pyspark.sql.functions import col, count, when\n\n    # Count the number of NULL values in each column\n    null_counts = df.select([count(when(col(c).isNull(), c)).alias(c) for c in df.columns])\n\n    # Check if there are any NULL values in any column\n    for c in null_counts.columns:\n        if null_counts.first()[c] > 0:\n            return False\n\n    return True\n\nresult = no_null_values(df)"}
{"key": "web_search:Top 10 tech companies by market cap", "value": "[{'title': 'Largest tech companies by market cap', 'link': 'https://companiesmarketcap.com/tech/largest-tech-companies-by-market-cap/', 'snippet': 'Largest tech companies by market cap ; 9. Tencent logo. Tencent. 9TCEHY. $428.71 B ; 10. Samsung logo. Samsung. 10005930.KS. $363.96 B ; 11. Broadcom logo.'}, {'title': '15 Biggest Global Tech Companies by Market Cap', 'link': 'https://www.yahoo.com/video/15-biggest-global-tech-companies-170240907.html', 'snippet': 'Oct 31, 2022 ... 15 Biggest Global Tech Companies by Market Cap \u00b7 15. Alibaba Group Holding Limited (NYSE:BABA) \u00b7 14. Cisco Systems, Inc. (NASDAQ:CSCO) \u00b7 13.'}, {'title': 'Top publicly traded tech companies by revenue', 'link': 'https://companiesmarketcap.com/tech/largest-tech-companies-by-revenue/', 'snippet': 'Top publicly traded tech companies by revenue ; 1. Amazon logo. Amazon. 1AMZN. $524.89 B ; 2. Apple logo. Apple. 2AAPL. $385.09 B ; 3. Alphabet (Google) logo.'}, {'title': 'Top 10 tech companies by market cap 2022 | Statista', 'link': 'https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/', 'snippet': 'Jan 13, 2023 ... In 2022, Apple was the leading tech company by market capitalization globally at around 2.2 trillion U.S. dollars. Microsoft ranked second\\xa0...'}, {'title': 'Companies ranked by Market Cap - CompaniesMarketCap.com', 'link': 'https://companiesmarketcap.com/', 'snippet': \"Ranking the world's top companies by market cap, market value, revenue and many more metrics.\"}, {'title': 'The Largest Companies by Market Cap in 2023 | The Motley Fool', 'link': 'https://www.fool.com/research/largest-companies-by-market-cap/', 'snippet': \"8 days ago ... Key findings. Apple is the largest company in the world, with a market cap of $2.89 trillion. It's followed by Microsoft ($2.47 trillion), Saudi\\xa0...\"}, {'title': 'Largest software companies by market cap', 'link': 'https://companiesmarketcap.com/software/largest-software-companies-by-market-cap/', 'snippet': 'Largest software companies by market cap ; 3. Alphabet (Google) logo. Alphabet (Google). 3GOOG. $1.569 T ; 4. Oracle logo. Oracle. 4ORCL. $327.28 B ; 5. Adobe logo.'}, {'title': 'Animation: The Biggest Tech Companies by Market Cap Over 23 ...', 'link': 'https://www.visualcapitalist.com/biggest-tech-companies-market-cap-23-years/', 'snippet': 'Mar 18, 2019 ... Artificial Intelligence: The Journey to a Thinking Machine ... Artificial intelligence could add 7% to global GDP over 10 years, but even with\\xa0...'}, {'title': 'Biggest Companies in the World by Market Cap', 'link': 'https://www.investopedia.com/biggest-companies-in-the-world-by-market-cap-5212784', 'snippet': 'Biggest Companies in the World by Market Cap \u00b7 1. Apple Inc. (AAPL) \u00b7 2. Saudi Aramco (2222.SR) \u00b7 3. Microsoft Corp. (MSFT) \u00b7 4. Alphabet Inc. (GOOGL) \u00b7 5. Amazon.'}, {'title': 'Top 1000 largest US Companies in the Technology sector by Market ...', 'link': 'https://disfold.com/united-states/sector/technology/companies/', 'snippet': 'Top 1000 largest US Companies in the Technology sector by Market Cap \u00b7 1. Apple \u00b7 2. Microsoft \u00b7 3. Nvidia \u00b7 4. Broadcom \u00b7 5. Oracle \u00b7 6. Cisco \u00b7 7. Adobe \u00b7 8. Texas\\xa0...'}]"}
{"key": "Given a Query and a list of Google Search Results, return the link\nfrom a reputable website which contains the data set to answer the question. {'The best search results should contain as many as possible of these info: company,cap,country'}\nQuery:Top 10 tech companies by market cap\nGoogle Search Results: \n```\n[{'title': 'Largest tech companies by market cap', 'link': 'https://companiesmarketcap.com/tech/largest-tech-companies-by-market-cap/', 'snippet': 'Largest tech companies by market cap ; 9. Tencent logo. Tencent. 9TCEHY. $428.71 B ; 10. Samsung logo. Samsung. 10005930.KS. $363.96 B ; 11. Broadcom logo.'}, {'title': '15 Biggest Global Tech Companies by Market Cap', 'link': 'https://www.yahoo.com/video/15-biggest-global-tech-companies-170240907.html', 'snippet': 'Oct 31, 2022 ... 15 Biggest Global Tech Companies by Market Cap \u00b7 15. Alibaba Group Holding Limited (NYSE:BABA) \u00b7 14. Cisco Systems, Inc. (NASDAQ:CSCO) \u00b7 13.'}, {'title': 'Top publicly traded tech companies by revenue', 'link': 'https://companiesmarketcap.com/tech/largest-tech-companies-by-revenue/', 'snippet': 'Top publicly traded tech companies by revenue ; 1. Amazon logo. Amazon. 1AMZN. $524.89 B ; 2. Apple logo. Apple. 2AAPL. $385.09 B ; 3. Alphabet (Google) logo.'}, {'title': 'Top 10 tech companies by market cap 2022 | Statista', 'link': 'https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/', 'snippet': 'Jan 13, 2023 ... In 2022, Apple was the leading tech company by market capitalization globally at around 2.2 trillion U.S. dollars. Microsoft ranked second\\xa0...'}, {'title': 'Companies ranked by Market Cap - CompaniesMarketCap.com', 'link': 'https://companiesmarketcap.com/', 'snippet': \"Ranking the world's top companies by market cap, market value, revenue and many more metrics.\"}, {'title': 'The Largest Companies by Market Cap in 2023 | The Motley Fool', 'link': 'https://www.fool.com/research/largest-companies-by-market-cap/', 'snippet': \"8 days ago ... Key findings. Apple is the largest company in the world, with a market cap of $2.89 trillion. It's followed by Microsoft ($2.47 trillion), Saudi\\xa0...\"}, {'title': 'Largest software companies by market cap', 'link': 'https://companiesmarketcap.com/software/largest-software-companies-by-market-cap/', 'snippet': 'Largest software companies by market cap ; 3. Alphabet (Google) logo. Alphabet (Google). 3GOOG. $1.569 T ; 4. Oracle logo. Oracle. 4ORCL. $327.28 B ; 5. Adobe logo.'}, {'title': 'Animation: The Biggest Tech Companies by Market Cap Over 23 ...', 'link': 'https://www.visualcapitalist.com/biggest-tech-companies-market-cap-23-years/', 'snippet': 'Mar 18, 2019 ... Artificial Intelligence: The Journey to a Thinking Machine ... Artificial intelligence could add 7% to global GDP over 10 years, but even with\\xa0...'}, {'title': 'Biggest Companies in the World by Market Cap', 'link': 'https://www.investopedia.com/biggest-companies-in-the-world-by-market-cap-5212784', 'snippet': 'Biggest Companies in the World by Market Cap \u00b7 1. Apple Inc. (AAPL) \u00b7 2. Saudi Aramco (2222.SR) \u00b7 3. Microsoft Corp. (MSFT) \u00b7 4. Alphabet Inc. (GOOGL) \u00b7 5. Amazon.'}, {'title': 'Top 1000 largest US Companies in the Technology sector by Market ...', 'link': 'https://disfold.com/united-states/sector/technology/companies/', 'snippet': 'Top 1000 largest US Companies in the Technology sector by Market Cap \u00b7 1. Apple \u00b7 2. Microsoft \u00b7 3. Nvidia \u00b7 4. Broadcom \u00b7 5. Oracle \u00b7 6. Cisco \u00b7 7. Adobe \u00b7 8. Texas\\xa0...'}]\n```\nThe answer MUST contain the url link only\n", "value": "https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/"}
{"key": "https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/", "value": "\nTop 10 tech companies by market cap 2022 | StatistaSkip to main contentStatista LogoStatista Logostatista.comstatista.esstatista.destatista.frPrices & Access\n            \n                                Single Accounts\n                            \n                            Business Solutions\n                        \n                                Academia and Government\n                            \n            Statistics\n            \n                                            All Industries\n                                        \n                                            Consumer Goods & FMCG\n                                        \n                                            Internet\n                                        \n                                            Media & Advertising\n                                        \n                                            Retail & Trade\n                                        \n                                            Sports & Recreation\n                                        \n                                            Technology & Telecommunications\n                                        \n                                            Transportation & Logistics\n                                        \n                                            Travel, Tourism & Hospitality\n                                        \n                                                Most-viewed Statistics\n                                            \n                                                Recent Statistics\n                                            \n                                                Popular Statistics\n                                            \n                                                        Quarterly smartphone market share worldwide by vendor 2009-2023\n                                                    \n                                                        Mobile phone users worldwide 2015-2020\n                                                    \n                                                        Apple iPhone unit sales worldwide 2007-2018, by quarter\n                                                    \n                                                        Global market share held by smartphone operating systems 2009-2018, by quarter\n                                                    \n                                                        Smartphone users in India 2010-2040\n                                                    \n                                                Topics\n                                            \n                                                    More Topics\n                                                \n                                                            Smartphones - statistics & facts\n                                                        \n                                                            Virtual reality (VR) - statistics & facts\n                                                        \n                                                    Top Report\n                                                View Report\n        Reports\n        \n                        Report Shop\n                    Search our report databaseDigital & TrendsDigital & Trend reportsOverview and forecasts on trending topicsIndustries & MarketsIndustry & Market reportsIndustry and market insights and forecastsCompanies & ProductsCompanies & Products reportsKey figures and rankings about companies and productsConsumers & BrandsConsumer & Brand reportsConsumer and brand insights and preferences in various industriesPolitics & SocietyPolitics & Society reportsDetailed information about political and social topicsCountries & RegionsCountry & Region reportsAll key figures about countries and regions\n                        Find your information in our database containing over 20,000 reports\n                        \n        Insights\n        \n            New\n        Market Insights\n                    Market forecast and expert KPIs for 1000+ markets in 190+ countries & territories\n                \n                            Explore Market Insights\n                            \n                            Consumer\n                        \n                            Digital\n                        \n                            Mobility\n                        Consumer Insights\n                            Insights on consumer attitudes and behavior worldwide\n                        \n                                2,000,000+ interviews\n                            \n                                15,000+ brands\n                            \n                        Explore Consumer Insights\n                        Company Insights\n                    Business information on 70m+ public and private companies\n                \n                        100+ industries\n                    \n                        200+ countries and territories\n                    Explore Company Insights\n                        eCommerce Insights\n                        Detailed information for 35,000+ online stores and marketplaces\n                    \n                            70+ KPIs per store\n                        \n                            Revenue analytics and forecasts\n                        \n                        Explore eCommerce Insights\n                        \n        Infographics\n    \n        Services\n        \n                    The Statistics Portal\n                \n                \n                    Directly accessible data for 170 industries from 50 countries and over 1 million facts:\n                \n            \n                        About Statista\n                        Why trust Statista\n                        First Steps and Help Centre\n                            \n                    Live webinars & recordings\n                \n                        \n                        Tools\n                    \n                            Business Plan Export\n                            Publication Finder\n                            \n                            Statista Services\n                    \n                                Statista Q\n                            \n                                \n                    Customized Research & Analysis projects:\n                \n                            \n                            Statista Q\n                            \n                                askStatista\n                            \n                                \n                    Get quick analyses with our professional research service\n                \n                            \n                            askStatista\n                                \n                                Statista R\n                            \n                                The best of the best: the portal for top lists & rankings:\n                            \n                            Statista R\n                            \n                        Statista Content & Design\n                    \n                        Transforming Data into Design:\n                    Customized infographic servicePresentation DesignAnimated videosWhitepapers, E-Books, etc.\n                        Statista Content & Design\n                        \n                        nxt statista\n                    \n                        Strategy and business building for the data-driven economy:\n                    \n                    nxt statista\n                    Prices & AccessSingle AccountsBusiness SolutionsAcademia and GovernmentStatisticsPopular StatisticsTopicsMarketsReportsMarket InsightsConsumer InsightsCompany InsightseCommerce InsightsInfographicsServicesContent & DesignResearch projectsAsk StatistaBusiness Plan ExportPublication FinderStatista RDEESFRTechnology & Telecommunications\n                            Leading tech companies worldwide 2022, by market cap\n                        \n                                                                                                    Published by\n                                    Federica Laricchia,\n                                    \n                                                                            Jan 13, 2023\n                                                                    \n                            In 2022, Apple was the leading tech company by market capitalization globally at around 2.2 trillion U.S. dollars. Microsoft ranked second, totaling around 1.8 trillion U.S. dollars in market capitalization. Alphabet (Google), Amazon, and Tesla were also in the top ten. By contrast, Samsung ranked tenth, with a market capitalization of over 300 billion U.S. dollars.\r\n\r\nApple  \r\n\r\nSince its foundation in a Californian garage in 1976, Apple expanded massively and became one of the most valuable companies in the world. The company started its origins in the PC industry with the Macintosh, but soon entered other segments of the consumer electronics market. Today, the iPhone is the most profitable Apple product, although Mac, iPad, wearables, and services also contribute to its high revenues. Aiming at innovation, Apple invests every year in research and development, with its latest hardware product, an AR headset, to be released in 2023.\r\n\r\nSamsung \r\n\r\nApple\u2019s biggest rival in the consumer electronics industry is the South Korean tech giant Samsung. Founded in 1938 as a trading company, it developed in several sectors, including electronics and insurance, recording revenues in excess of 200 billion U.S. dollars over recent years. Despite Samsung being active in several markets across multiple divisions, it is today best known for its consumer tech products. Smartphones, tablets, and TVs are among the most popular. Samsung sits as the leading smartphone vendor, holding a market share of over 20 percent through 2022.   \n                            \n                                Read more\n                            \n                        Leading tech companies worldwide 2022, by market capitalization \n                    \n                            (in billion U.S. dollars)\n                        \n                                    table\n                                \n                                    column chart\n                                CharacteristicMarket capitalization in billion U.S. dollarsApple2,242Microsoft1,821Alphabet (Google)1,229Amazon902.4Tesla541.4TSMC410.9NVIDIA401.7Tencet377.8Meta Platforms (Facebook)302.1Samsung301.7\n                                                Loading statistic... \n                                            \n                                    Additional Information\n                                \u00a9 Statista 2023\n                                Show source\n                                \n                Download for free\n            \n                        Download\n                    PDF+XLS+PNG+PPT+SourceShow detailed source information?Register for freeAlready a member?Log inSource\n                                Show sources information\n                            \n                                Show publisher information\n                            \n                                Use Ask Statista Research Service\n                            \n                            Release date\n                        December 2022More information\n                            Region\n                        WorldwideSurvey time period2022\n                    Supplementary notes\n                The date of release is the date of access.Citation formatsCitation formats\n                        View options\n                    Other statistics on the topic+Financial Instruments & InvestmentsLondon Stock Exchange (UK): largest technology companies 2022IT ServicesIT, software and computer services economy employment in the UK 2011-2021+TelecommunicationsIT services and software market value in the United Kingdom (UK) 2009-2017Medical TechnologyCompanies in the life science industry sector United Kingdom (UK) 2021, by sector\n                                Federica Laricchia\n                            \n                                Research expert covering the global consumer technology industry\n                            Get in touch with us now\n                    \n                    Profit from additional features with an Employee Account\n                \n                \n                    \n                    Please create an employee account to be able to mark statistics as favorites.\n                    Then you can access your favorite statistics via the star in the header.\n                \n                \n                    Register now\n                \n                    \n                    Profit from the additional features of your individual account\n                \n                \n                    \n                    Currently, you are using a shared account. To use individual functions (e.g., mark statistics as favourites, set\n                    statistic alerts) please log in with your personal account.\n                    If you are an admin, please authenticate by logging in again.\n                \n                \n                    Login\n                To access this feature you need a Statista AccountRegister for freeAlready have an account?\n    LoginYou need one of our Business Solutions to use this functionImmediate access to statistics, forecasts & reportsUsage and publication rightsDownload in various formatsView Business SolutionsAlready have an account?\n    LoginStatista Accounts:\n                                                                                                                                                                    Access All Statistics. Starting from $588 USD\u00a0/\u00a0Year\n                        Basic Account\n                Get to know the platformYou only have access to basic statistics.Starter AccountThe ideal entry-level account for individual usersInstant access\u00a0to 1m statisticsDownload\u00a0in XLS, PDF & PNG formatDetailed\u00a0references$69 USD\u00a0$49 USD\u00a0/\u00a0Month *\n                                        in the first 12 months\n                                    Professional AccountFull accessBusiness Solutions including all features.\n            \n                        * Prices do not include sales tax.\n                \n        \n                Other statistics that may interest you\n            The most important statisticsLondon Stock Exchange (UK): market cap of technology companies 2022London Stock Exchange (UK): largest technology companies 2022IT services and software market value in the United Kingdom (UK) 2009-2017IT, software and computer services industry GVA in the UK 2010-2021IT, software and computer services economy employment in the UK 2011-2021Investments made to improve digital marketing in the UK 2021The most important statisticsNumber of biotechnology R&D enterprises in the UK 2008-2020Turnover of biotechnology R&D enterprises in the United Kingdom (UK) 2008-2020GVA of biotechnology research and development enterprises in the UK 2008-2020Medical technology service sector employment in the United Kingdom 2021, by regionCompanies in the biopharmaceutical sector in the United Kingdom 2017, by segmentBiopharmaceutical companies by turnover size band in the United Kingdom (UK) 2017Biopharmaceutical companies by employment size in the United Kingdom (UK) 2017Industrial biotechnology employment CAGR in the United Kingdom (UK) 2009-2014The most important statisticsCompanies in the life science industry sector United Kingdom (UK) 2021, by sectorlife science sectors employment compound annual growth rate in the UK 2016, by sectorLife science sectors turnover compound annual growth rate in the UK 2016, by sectorMedical technology companies by turnover size band in the United Kingdom (UK) 2017Medical technology companies by employment size band in the United Kingdom (UK) 2017Medical technology: companies in the major segments in the United Kingdom (UK) 2017Medical technology segment turnover CAGR in the United Kingdom (UK) 2011-2016Medical technology employment CAGR in the United Kingdom (UK) 2011-2016The most important statisticsSoftware publishing sector GVA in the UK 2010-2021United Kingdom (UK): Packaged software sales 2008-2017UK cyber security: total software & IT services market size 2010-2017UK cyber security: software solution segment size 2010-2017Number of software publishing businesses in the UK from 2010-2022Employment in computer programming activities in the UK 2011-2021Programmers and software developers outside the UK creative industries 2011-2021Computer software and games: weekly UK household expenditure 2021, by gross incomeOther statistics that may interest you \n                Overview\n            \n                6\n            \n                                Premium Statistic\n                            London Stock Exchange (UK): market cap of technology companies 2022\n                                Premium Statistic\n                            London Stock Exchange (UK): largest technology companies 2022\n                                Premium Statistic\n                            IT services and software market value in the United Kingdom (UK) 2009-2017\n                                Basic Statistic\n                            IT, software and computer services industry GVA in the UK 2010-2021\n                                Basic Statistic\n                            IT, software and computer services economy employment in the UK 2011-2021\n                                Premium Statistic\n                            Investments made to improve digital marketing in the UK 2021\n                Biotechnology\n            \n                8\n            \n                                Basic Statistic\n                            Number of biotechnology R&D enterprises in the UK 2008-2020\n                                Basic Statistic\n                            Turnover of biotechnology R&D enterprises in the United Kingdom (UK) 2008-2020\n                                Basic Statistic\n                            GVA of biotechnology research and development enterprises in the UK 2008-2020\n                                Basic Statistic\n                            Medical technology service sector employment in the United Kingdom 2021, by region\n                                Basic Statistic\n                            Companies in the biopharmaceutical sector in the United Kingdom 2017, by segment\n                                Basic Statistic\n                            Biopharmaceutical companies by turnover size band in the United Kingdom (UK) 2017\n                                Premium Statistic\n                            Biopharmaceutical companies by employment size in the United Kingdom (UK) 2017\n                                Basic Statistic\n                            Industrial biotechnology employment CAGR in the United Kingdom (UK) 2009-2014\n                Medical Technology\n            \n                8\n            \n                                Basic Statistic\n                            Companies in the life science industry sector United Kingdom (UK) 2021, by sector\n                                Basic Statistic\n                            life science sectors employment compound annual growth rate in the UK 2016, by sector\n                                Basic Statistic\n                            Life science sectors turnover compound annual growth rate in the UK 2016, by sector\n                                Premium Statistic\n                            Medical technology companies by turnover size band in the United Kingdom (UK) 2017\n                                Premium Statistic\n                            Medical technology companies by employment size band in the United Kingdom (UK) 2017\n                                Basic Statistic\n                            Medical technology: companies in the major segments in the United Kingdom (UK) 2017\n                                Basic Statistic\n                            Medical technology segment turnover CAGR in the United Kingdom (UK) 2011-2016\n                                Basic Statistic\n                            Medical technology employment CAGR in the United Kingdom (UK) 2011-2016\n                Software\n            \n                8\n            \n                                Basic Statistic\n                            Software publishing sector GVA in the UK 2010-2021\n                                Premium Statistic\n                            United Kingdom (UK): Packaged software sales 2008-2017\n                                Basic Statistic\n                            UK cyber security: total software & IT services market size 2010-2017\n                                Basic Statistic\n                            UK cyber security: software solution segment size 2010-2017\n                                Premium Statistic\n                            Number of software publishing businesses in the UK from 2010-2022\n                                Premium Statistic\n                            Employment in computer programming activities in the UK 2011-2021\n                                Premium Statistic\n                            Programmers and software developers outside the UK creative industries 2011-2021\n                                Premium Statistic\n                            Computer software and games: weekly UK household expenditure 2021, by gross incomeFurther Content: You might find this interesting as well\n                TopicsTech Companies in the United Kingdom (UK)Business digitizationBiotech drugsBig dataEnterprise softwareStatista Accounts:\n                                                                                                                                                                    Access All Statistics. Starting from $588 USD\u00a0/\u00a0YearLearn more about how Statista can support your business.Request webinarCompaniesMarketCap.com. (December 8, 2022). Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars) [Graph]. In Statista. Retrieved June 24, 2023, from https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com. \"Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars).\" Chart. December 8, 2022. Statista. Accessed June 24, 2023. https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com. (2022). Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars). Statista. Statista Inc.. Accessed: June 24, 2023. https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com. \"Leading Tech Companies Worldwide 2022, by Market Capitalization (in Billion U.S. Dollars).\" Statista, Statista Inc., 8 Dec 2022, https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com, Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars) Statista, https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/ (last visited June 24, 2023)Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars) [Graph], CompaniesMarketCap.com, December 8, 2022. [Online]. Available: https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/HomeAbout StatistaCareerContactHelp & FAQReport BugOur Media Partners PrivacyImprintMenu\n                        Prices & Access\n                    \n                    Popular Statistics\n                \n                    Industries\n                \n                    Infographics\n                \n                    Content & Design projects\n                \n                    Research projects\n                \n                        AskStatista\n                    \n                                statista.de\n                            \n                                statista.es\n                            \n                                statista.fr\n                            "}
{"key": "Given the following question:\n```\nTop 10 tech companies by market cap\n```\nI got the following answer from a web page:\n```\nTop 10 tech companies by market cap 2022 | StatistaSkip to main contentStatista LogoStatista Logostatista.comstatista.esstatista.destatista.frPrices & Access Single Accounts Business Solutions Academia and Government Statistics All Industries Consumer Goods & FMCG Internet Media & Advertising Retail & Trade Sports & Recreation Technology & Telecommunications Transportation & Logistics Travel, Tourism & Hospitality Most-viewed Statistics Recent Statistics Popular Statistics Quarterly smartphone market share worldwide by vendor 2009-2023 Mobile phone users worldwide 2015-2020 Apple iPhone unit sales worldwide 2007-2018, by quarter Global market share held by smartphone operating systems 2009-2018, by quarter Smartphone users in India 2010-2040 Topics More Topics Smartphones - statistics & facts Virtual reality (VR) - statistics & facts Top Report View Report Reports Report Shop Search our report databaseDigital & TrendsDigital & Trend reportsOverview and forecasts on trending topicsIndustries & MarketsIndustry & Market reportsIndustry and market insights and forecastsCompanies & ProductsCompanies & Products reportsKey figures and rankings about companies and productsConsumers & BrandsConsumer & Brand reportsConsumer and brand insights and preferences in various industriesPolitics & SocietyPolitics & Society reportsDetailed information about political and social topicsCountries & RegionsCountry & Region reportsAll key figures about countries and regions Find your information in our database containing over 20,000 reports Insights New Market Insights Market forecast and expert KPIs for 1000+ markets in 190+ countries & territories Explore Market Insights Consumer Digital Mobility Consumer Insights Insights on consumer attitudes and behavior worldwide 2,000,000+ interviews 15,000+ brands Explore Consumer Insights Company Insights Business information on 70m+ public and private companies 100+ industries 200+ countries and territories Explore Company Insights eCommerce Insights Detailed information for 35,000+ online stores and marketplaces 70+ KPIs per store Revenue analytics and forecasts Explore eCommerce Insights Infographics Services The Statistics Portal Directly accessible data for 170 industries from 50 countries and over 1 million facts: About Statista Why trust Statista First Steps and Help Centre Live webinars & recordings Tools Business Plan Export Publication Finder Statista Services Statista Q Customized Research & Analysis projects: Statista Q askStatista Get quick analyses with our professional research service askStatista Statista R The best of the best: the portal for top lists & rankings: Statista R Statista Content & Design Transforming Data into Design: Customized infographic servicePresentation DesignAnimated videosWhitepapers, E-Books, etc. Statista Content & Design nxt statista Strategy and business building for the data-driven economy: nxt statista Prices & AccessSingle AccountsBusiness SolutionsAcademia and GovernmentStatisticsPopular StatisticsTopicsMarketsReportsMarket InsightsConsumer InsightsCompany InsightseCommerce InsightsInfographicsServicesContent & DesignResearch projectsAsk StatistaBusiness Plan ExportPublication FinderStatista RDEESFRTechnology & Telecommunications Leading tech companies worldwide 2022, by market cap Published by Federica Laricchia, Jan 13, 2023 In 2022, Apple was the leading tech company by market capitalization globally at around 2.2 trillion U.S. dollars. Microsoft ranked second, totaling around 1.8 trillion U.S. dollars in market capitalization. Alphabet (Google), Amazon, and Tesla were also in the top ten. By contrast, Samsung ranked tenth, with a market capitalization of over 300 billion U.S. dollars. Apple Since its foundation in a Californian garage in 1976, Apple expanded massively and became one of the most valuable companies in the world. The company started its origins in the PC industry with the Macintosh, but soon entered other segments of the consumer electronics market. Today, the iPhone is the most profitable Apple product, although Mac, iPad, wearables, and services also contribute to its high revenues. Aiming at innovation, Apple invests every year in research and development, with its latest hardware product, an AR headset, to be released in 2023. Samsung Apple\u2019s biggest rival in the consumer electronics industry is the South Korean tech giant Samsung. Founded in 1938 as a trading company, it developed in several sectors, including electronics and insurance, recording revenues in excess of 200 billion U.S. dollars over recent years. Despite Samsung being active in several markets across multiple divisions, it is today best known for its consumer tech products. Smartphones, tablets, and TVs are among the most popular. Samsung sits as the leading smartphone vendor, holding a market share of over 20 percent through 2022. Read more Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars) table column chart CharacteristicMarket capitalization in billion U.S. dollarsApple2,242Microsoft1,821Alphabet (Google)1,229Amazon902.4Tesla541.4TSMC410.9NVIDIA401.7Tencet377.8Meta Platforms (Facebook)302.1Samsung301.7 Loading statistic... Additional Information \u00a9 Statista 2023 Show source Download for free Download PDF+XLS+PNG+PPT+SourceShow detailed source information?Register for freeAlready a member?Log inSource Show sources information Show publisher information Use Ask Statista Research Service Release date December 2022More information Region WorldwideSurvey time period2022 Supplementary notes The date of release is the date of access.Citation formatsCitation formats View options Other statistics on the topic+Financial Instruments & InvestmentsLondon Stock Exchange (UK): largest technology companies 2022IT ServicesIT, software and computer services economy employment in the UK 2011-2021+TelecommunicationsIT services and software market value in the United Kingdom (UK) 2009-2017Medical TechnologyCompanies in the life science industry sector United Kingdom (UK) 2021, by sector Federica Laricchia Research expert covering the global consumer technology industry Get in touch with us now Profit from additional features with an Employee Account Please create an employee account to be able to mark statistics as favorites. Then you can access your favorite statistics via the star in the header. Register now Profit from the additional features of your individual account Currently, you are using a shared account. To use individual functions (e.g., mark statistics as favourites, set statistic alerts) please log in with your personal account. If you are an admin, please authenticate by logging in again. Login To access this feature you need a Statista AccountRegister for freeAlready have an account? LoginYou need one of our Business Solutions to use this functionImmediate access to statistics, forecasts & reportsUsage and publication rightsDownload in various formatsView Business SolutionsAlready have an account? LoginStatista Accounts: Access All Statistics. Starting from $588 USD / Year Basic Account Get to know the platformYou only have access to basic statistics.Starter AccountThe ideal entry-level account for individual usersInstant access to 1m statisticsDownload in XLS, PDF & PNG formatDetailed references$69 USD $49 USD / Month * in the first 12 months Professional AccountFull accessBusiness Solutions including all features. * Prices do not include sales tax. Other statistics that may interest you The most important statisticsLondon Stock Exchange (UK): market cap of technology companies 2022London Stock Exchange (UK): largest technology companies 2022IT services and software market value in the United Kingdom (UK) 2009-2017IT, software and computer services industry GVA in the UK 2010-2021IT, software and computer services economy employment in the UK 2011-2021Investments made to improve digital marketing in the UK 2021The most important statisticsNumber of biotechnology R&D enterprises in the UK 2008-2020Turnover of biotechnology R&D enterprises in the United Kingdom (UK) 2008-2020GVA of biotechnology research and development enterprises in the UK 2008-2020Medical technology service sector employment in the United Kingdom 2021, by regionCompanies in the biopharmaceutical sector in the United Kingdom 2017, by segmentBiopharmaceutical companies by turnover size band in the United Kingdom (UK) 2017Biopharmaceutical companies by employment size in the United Kingdom (UK) 2017Industrial biotechnology employment CAGR in the United Kingdom (UK) 2009-2014The most important statisticsCompanies in the life science industry sector United Kingdom (UK) 2021, by sectorlife science sectors employment compound annual growth rate in the UK 2016, by sectorLife science sectors turnover compound annual growth rate in the UK 2016, by sectorMedical technology companies by turnover size band in the United Kingdom (UK) 2017Medical technology companies by employment size band in the United Kingdom (UK) 2017Medical technology: companies in the major segments in the United Kingdom (UK) 2017Medical technology segment turnover CAGR in the United Kingdom (UK) 2011-2016Medical technology employment CAGR in the United Kingdom (UK) 2011-2016The most important statisticsSoftware publishing sector GVA in the UK 2010-2021United Kingdom (UK): Packaged software sales 2008-2017UK cyber security: total software & IT services market size 2010-2017UK cyber security: software solution segment size 2010-2017Number of software publishing businesses in the UK from 2010-2022Employment in computer programming activities in the UK 2011-2021Programmers and software developers outside the UK creative industries 2011-2021Computer software and games: weekly UK household expenditure 2021, by gross incomeOther statistics that may interest you Overview 6 Premium Statistic London Stock Exchange (UK): market cap of technology companies 2022 Premium Statistic London Stock Exchange (UK): largest technology companies 2022 Premium Statistic IT services and software market value in the United Kingdom (UK) 2009-2017 Basic Statistic IT, software and computer services industry GVA in the UK 2010-2021 Basic Statistic IT, software and computer services economy employment in the UK 2011-2021 Premium Statistic Investments made to improve digital marketing in the UK 2021 Biotechnology 8 Basic Statistic Number of biotechnology R&D enterprises in the UK 2008-2020 Basic Statistic Turnover of biotechnology R&D enterprises in the United Kingdom (UK) 2008-2020 Basic Statistic GVA of biotechnology research and development enterprises in the UK 2008-2020 Basic Statistic Medical technology service sector employment in the United Kingdom 2021, by region Basic Statistic Companies in the biopharmaceutical sector in the United Kingdom 2017, by segment Basic Statistic Biopharmaceutical companies by turnover size band in the United Kingdom (UK) 2017 Premium Statistic Biopharmaceutical companies by employment size in the United Kingdom (UK) 2017 Basic Statistic Industrial biotechnology employment CAGR in the United Kingdom (UK) 2009-2014 Medical Technology 8 Basic Statistic Companies in the life science industry sector United Kingdom (UK) 2021, by sector Basic Statistic life science sectors employment compound annual growth rate in the UK 2016, by sector Basic Statistic Life science sectors turnover compound annual growth rate in the UK 2016, by sector Premium Statistic Medical technology companies by turnover size band in the United Kingdom (UK) 2017 Premium Statistic Medical technology companies by employment size band in the United Kingdom (UK) 2017 Basic Statistic Medical technology: companies in the major segments in the United Kingdom (UK) 2017 Basic Statistic Medical technology segment turnover CAGR in the United Kingdom (UK) 2011-2016 Basic Statistic Medical technology employment CAGR in the United Kingdom (UK) 2011-2016 Software 8 Basic Statistic Software publishing sector GVA in the UK 2010-2021 Premium Statistic United Kingdom (UK): Packaged software sales 2008-2017 Basic Statistic UK cyber security: total software & IT services market size 2010-2017 Basic Statistic UK cyber security: software solution segment size 2010-2017 Premium Statistic Number of software publishing businesses in the UK from 2010-2022 Premium Statistic Employment in computer programming activities in the UK 2011-2021 Premium Statistic Programmers and software developers outside the UK creative industries 2011-2021 Premium Statistic Computer software and games: weekly UK household expenditure 2021, by gross incomeFurther Content: You might find this interesting as well TopicsTech Companies in the United Kingdom (UK)Business digitizationBiotech drugsBig dataEnterprise softwareStatista Accounts: Access All Statistics. Starting from $588 USD / YearLearn more about how Statista can support your business.Request webinarCompaniesMarketCap.com. (December 8, 2022). Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars) [Graph]. In Statista. Retrieved June 24, 2023, from https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com. \"Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars).\" Chart. December 8, 2022. Statista. Accessed June 24, 2023. https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com. (2022). Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars). Statista. Statista Inc.. Accessed: June 24, 2023. https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com. \"Leading Tech Companies Worldwide 2022, by Market Capitalization (in Billion U.S. Dollars).\" Statista, Statista Inc., 8 Dec 2022, https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/CompaniesMarketCap.com, Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars) Statista, https://www.statista.com/statistics/1350976/leading-tech-companies-worldwide-by-market-cap/ (last visited June 24, 2023)Leading tech companies worldwide 2022, by market capitalization (in billion U.S. dollars\n```\nNow help me write a SQL query to store the answer into a temp view.\nHere is an example of how to store data into a temp view:\n```\nCREATE OR REPLACE TEMP VIEW movies AS SELECT * FROM VALUES('Citizen Kane', 1941), ('Schindler's List', 1993) AS v1(title, year)\n```\nThe result view MUST contain following columns: ['company', 'cap', 'country']\nThe answer MUST contain query only.\n", "value": "CREATE OR REPLACE TEMP VIEW top_tech_companies AS SELECT * FROM VALUES\n('Apple', 2242, 'USA'),\n('Microsoft', 1821, 'USA'),\n('Alphabet (Google)', 1229, 'USA'),\n('Amazon', 902.4, 'USA'),\n('Tesla', 541.4, 'USA'),\n('TSMC', 410.9, 'Taiwan'),\n('NVIDIA', 401.7, 'USA'),\n('Tencent', 377.8, 'China'),\n('Meta Platforms (Facebook)', 302.1, 'USA'),\n('Samsung', 301.7, 'South Korea')\nAS v1(company, cap, country)"}
{"key": "\nGiven a Spark temp view `temp_view_for_transform` with the following columns:\n```\ncompany: string\ncap: decimal(11,1)\ncountry: string\n```\nWrite a Spark SQL query to retrieve: companies in United States\nThe answer MUST contain query only.\n", "value": "SELECT * FROM temp_view_for_transform WHERE country = 'United States'"}
{"key": "You are an Apache Spark SQL expert, who can summary what a dataframe retrieves. Given an analyzed \nquery plan of a dataframe, you will \n1. convert the dataframe to SQL query. Note that an explain output contains plan \nnodes separated by `\\n`. Each plan node has its own expressions and expression ids. \n2. summary what the sql query retrieves. \n\n\n\nanalyzed_plan: \nGlobalLimit 100\n    +- LocalLimit 100\n       +- Sort [d_year ASC NULLS FIRST, sum_agg DESC NULLS LAST, brand_id ASC NULLS FIRST], true\n          +- Aggregate [d_year, i_brand, i_brand_id], [d_year, i_brand_id AS brand_id, i_brand AS brand, sum(ss_ext_sales_price) AS sum_agg]\n             +- Filter (((d_date_sk = ss_sold_date_sk) AND (ss_item_sk = i_item_sk)) AND ((i_manufact_id = 128) AND (d_moy = 11)))\n                +- Join Inner\n                   :- Join Inner\n                   :  :- SubqueryAlias dt\n                   :  :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.date_dim\n                   :  :     +- Relation spark_catalog.tpcds_sf1_delta.date_dim[d_date_sk,d_date_id,d_date,d_month_seq,d_week_seq,d_quarter_seq,d_year,d_dow,d_moy,d_dom,d_qoy,d_fy_year,d_fy_quarter_seq,d_fy_week_seq,d_day_name,d_quarter_name,d_holiday,d_weekend,d_following_holiday,d_first_dom,d_last_dom,d_same_day_ly,d_same_day_lq,d_current_day,... 4 more fields] parquet\n                   :  +- SubqueryAlias spark_catalog.tpcds_sf1_delta.store_sales\n                   :     +- Relation spark_catalog.tpcds_sf1_delta.store_sales[ss_sold_date_sk,ss_sold_time_sk,ss_item_sk,ss_customer_sk,ss_cdemo_sk,ss_hdemo_sk,ss_addr_sk,ss_store_sk,ss_promo_sk,ss_ticket_numberL,ss_quantity,ss_wholesale_cost,ss_list_price,ss_sales_price,ss_ext_discount_amt,ss_ext_sales_price,ss_ext_wholesale_cost,ss_ext_list_price,ss_ext_tax,ss_coupon_amt,ss_net_paid,ss_net_paid_inc_tax,ss_net_profit] parquet\n                   +- SubqueryAlias spark_catalog.tpcds_sf1_delta.item\n                      +- Relation spark_catalog.tpcds_sf1_delta.item[i_item_sk,i_item_id,i_rec_start_date,i_rec_end_date,i_item_desc,i_current_price,i_wholesale_cost,i_brand_id,i_brand,i_class_id,i_class,i_category_id,i_category,i_manufact_id,i_manufact,i_size,i_formulation,i_color,i_units,i_container,i_manager_id,i_product_name] parquet\n\nexplain: \nThe analyzed plan can be translated into the following SQL query:\n```sql\nSELECT\n  dt.d_year,\n  item.i_brand_id brand_id,\n  item.i_brand brand,\n  SUM(ss_ext_sales_price) sum_agg\nFROM date_dim dt, store_sales, item\nWHERE dt.d_date_sk = store_sales.ss_sold_date_sk\n  AND store_sales.ss_item_sk = item.i_item_sk\n  AND item.i_manufact_id = 128\n  AND dt.d_moy = 11\nGROUP BY dt.d_year, item.i_brand, item.i_brand_id\nORDER BY dt.d_year, sum_agg DESC, brand_id\nLIMIT 100\n```\nIn summary, this dataframe is retrieving the top 100 brands (specifically of items manufactured by manufacturer with id 128) with the highest total sales price for each year in the month of November. It presents the results sorted by year, total sales (in descending order), and brand id.\n\n\n\nanalyzed_plan: Project [company, cap, country]\n+- Filter (country = United States)\n   +- SubqueryAlias temp_view_for_transform\n      +- View (`temp_view_for_transform`, [company,cap,country])\n         +- SubqueryAlias top_tech_companies\n            +- View (`top_tech_companies`, [company,cap,country])\n               +- Project [cast(company as string) AS company, cast(cap as decimal(11,1)) AS cap, cast(country as string) AS country]\n                  +- Project [company, cap, country]\n                     +- SubqueryAlias v1\n                        +- LocalRelation [company, cap, country]\n\nexplain:", "value": "The analyzed plan can be translated into the following SQL query:\n```sql\nSELECT\n  company,\n  cap,\n  country\nFROM top_tech_companies\nWHERE country = 'United States'\n```\nIn summary, this dataframe is retrieving the company, market capitalization (cap), and country for all the top tech companies that are located in the United States."}
{"key": "\nGiven 1) a PySpark dataframe, df, and 2) a description of expected properties, desc,\ngenerate a Python function to test whether the given dataframe satisfies the expected properties.\nYour generated function should take 1 parameter, df, and the return type should be a boolean.\nYou will call the function, passing in df as the parameter, and return the output (True/False).\n\nIn total, your output must follow the format below, exactly (no explanation words):\n1. function definition f, in Python\n2. 1 blank new line\n3. Call f on df and assign the result to a variable, result: result = name_of_f(df)\n\nInclude any necessary import statements INSIDE the function definition.\nFor example:\ndef gen_random():\n    import random\n    return random.randint(0, 10)\n\nFor example:\nInput:\ndf = DataFrame[name: string, age: int]\ndesc = \"expect 5 columns\"\n\nOutput:\n\"def has_5_columns(df) -> bool:\n    # Get the number of columns in the DataFrame\n    num_columns = len(df.columns)\n\n    # Check if the number of columns is equal to 5\n    if num_columns == 5:\n        return True\n    else:\n        return False\n\nresult = has_5_columns(df)\"\n\nHere is your input df: DataFrame[company: string, cap: decimal(11,1), country: string]\nHere is your input description: expect all company names to be unique\n", "value": "def has_unique_company_names(df) -> bool:\n    from pyspark.sql.functions import countDistinct\n\n    # Get the number of unique company names in the DataFrame\n    unique_company_names = df.select(countDistinct(\"company\")).collect()[0][0]\n\n    # Get the total number of rows in the DataFrame\n    total_rows = df.count()\n\n    # Check if the number of unique company names is equal to the total number of rows\n    if unique_company_names == total_rows:\n        return True\n    else:\n        return False\n\nresult = has_unique_company_names(df)"}
{"key": "https://time.com/6235186/best-albums-2022/", "value": "\n\n\nThe Best Albums of 2022 | Time\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTIME logo\n\n\n\n\n\n\n\nConnect Wallet\n\n\n\nWallet Settings \nDisconnect Wallet\nMetaMask \nWalletConnect \n\n \n\n\n\n\n\n                          Sign In\n                        \n\n\n\n                          My Account\n                          \n\n\nMy Account\nDigital\n                            Magazines\nTIME Storefront\nHelp Center\nSign Out\n\n\n\n\n\n\n                                      Subscribe Now!\n                            \nSubscribe\n\n\n\n\n\n\n\n\n\nSpotlight \n                        Essay: Charlotte Fox Weber on Peter Beard\n                      \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nClose\n\n\n\n\n\n\n\n\n\n\n\n\nMy Account\n\n\nMy Account\n\n\nDigital\n                        Magazines\n\n\nTIME Storefront\n\n\nHelp Center\n\n\nSign Out\n\n\n\n\n\n\n                      Sign In\n                    \n\n\n\n                      Subscribe\n                    \n\n\n\n\nSections\n\n\n\n                      Home\n                    \n \n\n                      U.S.\n                    \n \n\n                      Politics\n                    \n \n\n                      World\n                    \n \n\n                      Health\n                    \n \n\n                      Climate\n                    \n \n\n                      Future of Work by Charter\n                    \n \n\n                      Business\n                    \n \n\n                      Tech\n                    \n \n\n                      Entertainment\n                    \n \n\n                      Ideas\n                    \n \n\n                      Science\n                    \n \n\n                      History\n                    \n \n\n                      Sports\n                    \n \n\n                      Magazine\n                    \n \n\n                      TIME 2030\n                    \n \n\n                      Next Generation Leaders\n                    \n \n\n                      TIME100 Leadership Series\n                    \n \n\n                      TIME Studios\n                    \n \n\n                      Video\n                    \n \n\n                      TIME100 Talks\n                    \n \n\n                      TIMEPieces\n                    \n \n\n                      The TIME Vault\n                    \n \n\n                      TIME for Health\n                    \n \n\n                      TIME for Kids\n                    \n \n\n                      TIME Edge\n                    \n \n\n                      TIME CO2\n                    \n \n\n                      Red Border: Branded Content by TIME\n                    \n \n\n                      Personal Finance by TIME Stamped\n                    \n \n\n                      Shopping by TIME Stamped\n                    \n \n\n\nJoin Us\n\n\n\n                      Newsletters\n                    \n \n\n                      Subscribe\n                    \n \n\n                      Give a Gift\n                    \n \n\n                      Shop the TIME Store\n                    \n \n\n                      TIME Cover Store\n                    \n \n\n\nCustomer Care\n\n\n\n                      US & Canada\n                    \n \n\n                      Global Help Center\n                    \n \n\n\nReach Out\n\n\n\n                      Careers\n                    \n \n\n                      Press Room\n                    \n \n\n                      Contact the Editors\n                    \n \n\n                      Media Kit\n                    \n \n\n                      Reprints and Permissions\n                    \n \n\n\nMore\n\n\n\n                      About Us\n                    \n \n\n                      Privacy Policy\n                    \n \n\n                      Your California Privacy Rights\n                    \n \n\n                      Terms of Use\n                    \n \n\n                      Site Map\n                    \n \n\n\nConnect with Us\n\n\n\n\n\n\n \n\n\n\n\n\n \n\n\n\n\n\n \n\n\n\n\n\n \n\n\n\n\n\n\n\n\n \n\n\n\n \n\n\n\n\n\n\n\nPresented By\n\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n                                      Entertainment\n                                  \n\n\n\n\n\n                                      Music\n                                  \n\n\n\n                              The 10 Best Albums of 2022\n                            \n\n\n \nThe 10 Best Albums of 2022\n \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n                    By \n                        \n                          Cady Lang\n                        \n                        ,\n                        \n                          Andrew R. Chow\n                        \n                        and\n                        \n                          Moises Mendez II\n                        \n\n\nNovember 20, 2022 8:00 AM EST\n\n\n\n\n\n\nA wealth of new albums in 2022 pushed the boundaries of genre, theme, and sound. From seasoned veterans like Beyonc\u00e9 and Kendrick Lamar, returning in triumph with fresh records and even fresher perspectives, to exciting young artists like Saya Gray, whose debut album, 19 Masters, should make any listener excited for the future of music, here are the albums that we\u2019ve had on repeat all year. 10. Motomami, Rosal\u00eda \n\n\n\n\n\n\n\n\n\n\n\n\n \n Rosal\u00eda\u2019s 2018 conceptual masterpiece El Mal Querer is so intentional and powerful that it\u2019s hard to imagine her topping it. But this year, she stepped entirely outside the box, pushing her creative ability to its absolute limit to make Motomami. \n\n\n On this album, she worked with some of the best musicians in the industry from rapper/producer Pharrell Williams, who lent a hand on \u201cLa Combi Versace\u201d and on title track \u201cHENTAI,\u201d to Frank Ocean, to James Blake, whose voice can be heard at the end of \u201cDIABLO.\u201d Motomami is a triumphant amalgamation of diverse genres, blending jazz, reggaeton, bachata, flamenco, and pop. Rosal\u00eda\u2019s unwavering tenacity has allowed her to create a piece of art that fully showcases her stunning vocal and producing abilities.\u2014Moises Mendez II 9. You Can\u2019t Kill Me, 070 Shake \n\n\n\n\n\n\n\n\n\n\n\n\n \n Danielle Balbuena, the New Jersey-born rapper and R&B singer better known as 070 Shake, has made a name for herself in the industry for defying easy definition. With a powerhouse voice and tough yet tender songwriting, she\u2019s transcended genre and challenged notions of identity, forging a path all her own that has garnered co-signs ranging from Kanye West, who signed her to his G.O.O.D. Music imprint in 2016, to indie rock darlings The 1975, with whom she toured during the early years of her career.  \n On her second album, You Can\u2019t Kill Me, Shake continues to hone a skill set entirely her own, serving up a project that\u2019s surprisingly measured but no less intense. Over heavy beats and ambient synths, Shake returns to her usual contemplations: the hardships and wonders of life, the ups and downs of love. Teeming with smoldering desire and melancholic angst, the result is a moody, sensual offering from a deeply vulnerable artist who refuses simply coolly exist. \u201cI wanted your body, but it came with your soul,\u201d she laments on \u201cBody,\u201d channeling a tension that feeds into our universal ennui.\u2014Cady Lang 8. Mr. Morale & The Big Steppers, Kendrick Lamar \n\n\n\n\n\n\n\n\n\n\n\n\n \n In his decade in the spotlight, Kendrick Lamar has amassed a reputation that borders on messianic\u2014he\u2019s the Pulitzer-winning, civil-rights-anthem-penning, Tupac-inheriting genius destined to carry his city, if not his race, if not the world, on his narrow shoulders. No one man could possibly live up to those unbearable and escalating standards, and on Mr. Morale, Lamar actively renounces them: \u201cKendrick made you think about it, but he is not your savior,\u201d he says pointedly on \u201cSavior.\u201d  \n But if Mr. Morale isn\u2019t an epoch-defining masterwork on the level of Good Kid, m.A.A.d City or To Pimp a Butterfly, it\u2019s still a fantastically rich portrait of an artist in crisis. Lamar navigates familial tensions, pandemic anxiety, hypocrisy, and crushing public expectations with sharpness and poignancy, especially on \u201cMother | Sober\u201d and the aforementioned \u201cSavior.\u201d And there are several deeply polarizing songs on the album\u2014including the domestic dispute \u201cWe Cry Together\u201d and the trans anthem \u201cAuntie Diaries\u201d\u2014that nevertheless show Lamar probing the boundaries of his comfort zone and embracing the risk of backlash in order to create art he believes in.\u2014Andrew R. Chow 7. Big Time, Angel Olsen  \n\n\n\n\n\n\n\n\n\n\n\n\n \n \u201cBig\u201d is the operative word for the sixth album from the indie rock mainstay Angel Olsen: Recorded soon after both her parents died, it deals in big emotions, big musical arrangements, big vocals, big themes of love, loss and depression and perseverance. And just as Olsen has thrived across a range of setups\u2014from acoustic solo to scruffy electric rock band\u2014she likewise excels in belting out hugely stirring songs that sound destined to blast during climactic slow dances or while movie credits roll.  \n The songs on \u201cBig Time\u201d build patiently, and with few indicators as to the year they were created: there are steel pedal guitars, burnished strings, zithers, and harmoniums. The lush arrangements augment Olsen\u2019s arguably strongest vocal performance yet: she brings both power and subtlety to wrenchingly stark lyrics like \u201cI know you can\u2019t talk long/ But I\u2019m barely hanging on/ I\u2019m so tired of telling you/ It\u2019s a hard time again.\u201d\u2014A.R.C.  6. Electricity, Ibibio Sound Machine  \n\n\n\n\n\n\n\n\n\n\n\n\n \n You\u2019d be hard-pressed to find a more combustible minute of pop music in 2022 than the one that starts from the halfway point of \u201cProtection From Evil,\u201d the opening track of Ibibio Sound Machine\u2019s fourth album Electricity. Frontwoman Eno Williams delivers a furious stream-of-consciousness soliloquy in the Ibibio language, her syllables spilling over and between the pounding four-on-the-floor dance beat; she lapses into a simmering chorus run through a vocoder, which then gives way to a shrieking horn section and a seizing synthesizer reminiscent of LCD Soundsystem\u2019s best work. Electricity is filled with moments like this: of breathtaking sonic rises and falls, astonishing cultural exchanges, and flat-out infectious dance music.\u2014A.R.C.   \n 5. It\u2019s Almost Dry, Pusha T  \n\n\n\n\n\n\n\n\n\n\n\n\n \n If the rapper and impresario Pusha T is the \u201cMartin Scorsese of street rap,\u201d as he hopes to be, then It\u2019s Almost Dry might just be his Goodfellas: an immersive gangster epic that\u2019s brutal yet stylish, materialistic, and psychologically probing. Pusha T doesn\u2019t stray far from his favorite topic\u2014hustling\u2014but he doesn\u2019t need to, because of the care with which he imbues his wordcraft and storytelling. His dense references will send you scrambling for Genius annotations: \u201dSummertime, Winterfell, I\u2019m the Night King/ The Colgate kilo, the hood needs whitening/ We fishscale n\u2014-s like we all Pisces/ Your bitch in my bubble like I\u2019m still typing,\u201d he raps on \u201cNeck and Wrist.\u201d But even if you don\u2019t catch all the double and triple entendres, the music sounds fantastically luxurious. He recruited some of the most renowned producers in hip-hop, from Kanye West to Pharrell, and they delivered their A-game.\u2014A.R.C. \n 4. Chloe and the Next 20th Century, Father John Misty \n\n\n\n\n\n\n\n\n\n\n\n\n \n The musical polymath Josh Tillman, better known as his stage alter ego, Father John Misty, has made a name for himself as the most polarizing (and possibly most talented) man in the contemporary folk rock scene. With Chloe and the 20th Century, his fifth studio album as FJM, however, he takes a surprising and delightful departure from his usual form for a project that\u2019s grandiose in its ambition, theatrical in its presentation, and thrilling in its execution.  Drawing on elements like big band, bossa nova, and film scores from the golden age of Hollywood, the album is a lush and lofty epic that spins fictional vintage narratives into song. Through tragic vignettes that read like a screenplay of a fantasy L.A., the tracks detail torrid love affairs, untimely ends, and heartbreak, for the titular Chloe and her motley crew, showcasing not only FJM\u2019s signature wry cynicism and penchant for melodrama, but an impressive flair for worldbuilding.\u2014C.L. \n 3. Renaissance, Beyonc\u00e9 \n\n\n\n\n\n\n\n\n\n\n\n\n \n Ahead of the release of Renaissance, her seventh solo studio album, Beyonc\u00e9 shared via social media that it was a creative project born out of a need for escape, freedom, and exploration during the pandemic. The spirit of release is omnipresent in the album, a true celebration of dance music and its Black queer history. From her first single off the album, \u201cBreak My Soul,\u201d where Bey and Big Freedia urge us to \u201crelease your job/ release the time\u201d to the dedication of the album to her late queer uncle, Johnny, the album is an homage to the Black queer pioneers of genres like disco, bounce, house, techno, funk, and ballroom. There are few artists who can drop an album late in the game and still commandeer \u201csong of the summer\u201d along with every dance floor, but as she tells us on \u201cAlien Superstar,\u201d Beyonc\u00e9 is and forever will be that girl.\u2014C.L. \n 2. 19 Masters, Saya Gray  \n\n\n\n\n\n\n\n\n\n\n\n\n \n The debut album from the Toronto-based singer-songwriter Gray is not for the stadium rafters. It\u2019s full of half-fleshed-out ideas, spindly guitar wanderings, washed-out vocal recordings and stray voice memos. But Gray\u2019s strange restraint and restless curiosity are entirely the point: In its scattered and shaggy structure, there\u2019s something compelling to be found around every melodic corner, whether on your second or tenth listen. In this way, the album feels like a worthy inheritor of Frank Ocean\u2019s lo-fi masterpiece Blonde. Gray layers her scratchy voice upon itself to build breathtaking harmonies, and the tones she wrings out of her guitar and bass are impeccable.\u2014A.R.C. \n 1. Un Verano Sin Ti, Bad Bunny \n\n\n\n\n\n\n\n\n\n\n\n\n \n No other album had as much universal appeal (and, let\u2019s be honest, adoration) this year than Un Verano Sin Ti, Bad Bunny\u2019s glorious fourth solo studio album. It\u2019s an album about heartbreak, yes, but also a veritable love letter to his homeland of Puerto Rico and a sonic tribute to the Caribbean diaspora. Driven by the musical styles of El Caribe, ranging from reggaeton and dembow to merengue and cumbia, and bolstered by elements of dance hall and techno, Benito firmly roots the album in the deeply personal, mining the universal experiences of love, loss, and the supreme pleasure of being alive, for an exceptional project that is genre-defying, intergenerational, and groundbreaking.  \n Never one to shy away from getting political, Bad Bunny also uses the project to critique hot-button issues, from the privatization of power in Puerto Rico to how the current crisis of gentrification on the island is part of a long and troubled history of colonization. To listen to this album, to move to it and be moved by it, is an act of defiance, celebration, and radical love.\u2014C.L. \n\nMore Must-Reads From TIME\n\n\n Essay: I Fell for a Famed Artist. Then He Got Violent Pride, Against All Odds\u00a0 Inside Zelensky's Battle Against Russian Propaganda How the Women\u2019s World Cup Evolved Into What It Is Today The Dangers of Unregulated Deep-Sea Tourism Podcast: Elliott Page Steps Into His Truth OpenAI's CEO Sam Altman Is Pushing Past Doubts on Artificial Intelligence These Are the 100 Most Influential Companies of 2023 \n Write to Cady Lang at cady.lang@timemagazine.com and Moises Mendez II at moises.mendez@time.com. \n\n\n \n\n\n\n\n\n\n\n\n \n\n\nYou May Also Like\n \n\n\n \n\n\n \n \n\n\n\nRead Next\n\n\n\nWhy Verified Fan Is Ruining the Concert Experience\n\n\n\n\n\nNext Up: Editor's Pick\n\n\n\nUnderwater Noise Pollution Is Disrupting Ocean Life\u2014But We Can Fix It\n\n\n\n\n\n\n\n EDIT POST\n\n\n\n\n\n\n\n\n\n\n\n                        Home\n                      \n\n\n\n                        U.S.\n                      \n\n\n\n                        Politics\n                      \n\n\n\n                        World\n                      \n\n\n\n                        Health\n                      \n\n\n\n                        Business\n                      \n\n\n\n                        Tech\n                      \n\n\n\n                        Personal Finance by TIME Stamped\n                      \n\n\n\n                        Shopping by TIME Stamped\n                      \n\n\n\n                        Future of Work by Charter\n                      \n\n\n\n\n\n\n\n                        Entertainment\n                      \n\n\n\n                        Ideas\n                      \n\n\n\n                        Science\n                      \n\n\n\n                        History\n                      \n\n\n\n                        Newsfeed\n                      \n\n\n\n                        Sports\n                      \n\n\n\n                        Magazine\n                      \n\n\n\n                        The TIME Vault\n                      \n\n\n\n                        TIME For Kids\n                      \n\n\n\n                        TIME CO2\n                      \n\n\n\n\n\n\n\n                        TIME Edge\n                      \n\n\n\n                        Video\n                      \n\n\n\n                        Masthead\n                      \n\n\n\n                        Newsletters\n                      \n\n\n\n                        Subscribe\n                      \n\n\n\n                        Subscriber Benefits\n                      \n\n\n\n                        Give a Gift\n                      \n\n\n\n                        Shop the TIME Store\n                      \n\n\n\n                        Careers\n                      \n\n\n\n\n\n\n\n                        Press Room\n                      \n\n\n\n                        TIME Studios\n                      \n\n\n\n                        U.S. & Canada Customer Care\n                      \n\n\n\n                        Global Help Center\n                      \n\n\n\n                        Contact the Editors\n                      \n\n\n\n                        Reprints and Permissions\n                      \n\n\n\n                        Site Map\n                      \n\n\n\n                        Media Kit\n                      \n\n\n\n                        Supplied Partner Content\n                      \n\n\n\n                        About Us\n                      \n\n\n\n\n\n             \u00a9 2023 TIME USA, LLC. All Rights Reserved. Use of this site constitutes acceptance of our Terms of Service, Privacy Policy (Your California Privacy Rights) and Do Not Sell or Share My Personal Information. TIME may receive compensation for some links to products and services on this website. Offers may be subject to change without notice.  \n        \n\n\n\n\n\n\n\n\n\n\n"}
{"key": "Given the following question:\n```\nThe Best Albums of 2022 | Time\n```\nI got the following answer from a web page:\n```\nThe Best Albums of 2022 | Time TIME logo Connect Wallet Wallet Settings Disconnect Wallet MetaMask WalletConnect Sign In My Account My Account Digital Magazines TIME Storefront Help Center Sign Out Subscribe Now! Subscribe Spotlight Essay: Charlotte Fox Weber on Peter Beard Close My Account My Account Digital Magazines TIME Storefront Help Center Sign Out Sign In Subscribe Sections Home U.S. Politics World Health Climate Future of Work by Charter Business Tech Entertainment Ideas Science History Sports Magazine TIME 2030 Next Generation Leaders TIME100 Leadership Series TIME Studios Video TIME100 Talks TIMEPieces The TIME Vault TIME for Health TIME for Kids TIME Edge TIME CO2 Red Border: Branded Content by TIME Personal Finance by TIME Stamped Shopping by TIME Stamped Join Us Newsletters Subscribe Give a Gift Shop the TIME Store TIME Cover Store Customer Care US & Canada Global Help Center Reach Out Careers Press Room Contact the Editors Media Kit Reprints and Permissions More About Us Privacy Policy Your California Privacy Rights Terms of Use Site Map Connect with Us Presented By Entertainment Music The 10 Best Albums of 2022 The 10 Best Albums of 2022 By Cady Lang , Andrew R. Chow and Moises Mendez II November 20, 2022 8:00 AM EST A wealth of new albums in 2022 pushed the boundaries of genre, theme, and sound. From seasoned veterans like Beyonc\u00e9 and Kendrick Lamar, returning in triumph with fresh records and even fresher perspectives, to exciting young artists like Saya Gray, whose debut album, 19 Masters, should make any listener excited for the future of music, here are the albums that we\u2019ve had on repeat all year. 10. Motomami, Rosal\u00eda Rosal\u00eda\u2019s 2018 conceptual masterpiece El Mal Querer is so intentional and powerful that it\u2019s hard to imagine her topping it. But this year, she stepped entirely outside the box, pushing her creative ability to its absolute limit to make Motomami. On this album, she worked with some of the best musicians in the industry from rapper/producer Pharrell Williams, who lent a hand on \u201cLa Combi Versace\u201d and on title track \u201cHENTAI,\u201d to Frank Ocean, to James Blake, whose voice can be heard at the end of \u201cDIABLO.\u201d Motomami is a triumphant amalgamation of diverse genres, blending jazz, reggaeton, bachata, flamenco, and pop. Rosal\u00eda\u2019s unwavering tenacity has allowed her to create a piece of art that fully showcases her stunning vocal and producing abilities.\u2014Moises Mendez II 9. You Can\u2019t Kill Me, 070 Shake Danielle Balbuena, the New Jersey-born rapper and R&B singer better known as 070 Shake, has made a name for herself in the industry for defying easy definition. With a powerhouse voice and tough yet tender songwriting, she\u2019s transcended genre and challenged notions of identity, forging a path all her own that has garnered co-signs ranging from Kanye West, who signed her to his G.O.O.D. Music imprint in 2016, to indie rock darlings The 1975, with whom she toured during the early years of her career. On her second album, You Can\u2019t Kill Me, Shake continues to hone a skill set entirely her own, serving up a project that\u2019s surprisingly measured but no less intense. Over heavy beats and ambient synths, Shake returns to her usual contemplations: the hardships and wonders of life, the ups and downs of love. Teeming with smoldering desire and melancholic angst, the result is a moody, sensual offering from a deeply vulnerable artist who refuses simply coolly exist. \u201cI wanted your body, but it came with your soul,\u201d she laments on \u201cBody,\u201d channeling a tension that feeds into our universal ennui.\u2014Cady Lang 8. Mr. Morale & The Big Steppers, Kendrick Lamar In his decade in the spotlight, Kendrick Lamar has amassed a reputation that borders on messianic\u2014he\u2019s the Pulitzer-winning, civil-rights-anthem-penning, Tupac-inheriting genius destined to carry his city, if not his race, if not the world, on his narrow shoulders. No one man could possibly live up to those unbearable and escalating standards, and on Mr. Morale, Lamar actively renounces them: \u201cKendrick made you think about it, but he is not your savior,\u201d he says pointedly on \u201cSavior.\u201d But if Mr. Morale isn\u2019t an epoch-defining masterwork on the level of Good Kid, m.A.A.d City or To Pimp a Butterfly, it\u2019s still a fantastically rich portrait of an artist in crisis. Lamar navigates familial tensions, pandemic anxiety, hypocrisy, and crushing public expectations with sharpness and poignancy, especially on \u201cMother | Sober\u201d and the aforementioned \u201cSavior.\u201d And there are several deeply polarizing songs on the album\u2014including the domestic dispute \u201cWe Cry Together\u201d and the trans anthem \u201cAuntie Diaries\u201d\u2014that nevertheless show Lamar probing the boundaries of his comfort zone and embracing the risk of backlash in order to create art he believes in.\u2014Andrew R. Chow 7. Big Time, Angel Olsen \u201cBig\u201d is the operative word for the sixth album from the indie rock mainstay Angel Olsen: Recorded soon after both her parents died, it deals in big emotions, big musical arrangements, big vocals, big themes of love, loss and depression and perseverance. And just as Olsen has thrived across a range of setups\u2014from acoustic solo to scruffy electric rock band\u2014she likewise excels in belting out hugely stirring songs that sound destined to blast during climactic slow dances or while movie credits roll. The songs on \u201cBig Time\u201d build patiently, and with few indicators as to the year they were created: there are steel pedal guitars, burnished strings, zithers, and harmoniums. The lush arrangements augment Olsen\u2019s arguably strongest vocal performance yet: she brings both power and subtlety to wrenchingly stark lyrics like \u201cI know you can\u2019t talk long/ But I\u2019m barely hanging on/ I\u2019m so tired of telling you/ It\u2019s a hard time again.\u201d\u2014A.R.C. 6. Electricity, Ibibio Sound Machine You\u2019d be hard-pressed to find a more combustible minute of pop music in 2022 than the one that starts from the halfway point of \u201cProtection From Evil,\u201d the opening track of Ibibio Sound Machine\u2019s fourth album Electricity. Frontwoman Eno Williams delivers a furious stream-of-consciousness soliloquy in the Ibibio language, her syllables spilling over and between the pounding four-on-the-floor dance beat; she lapses into a simmering chorus run through a vocoder, which then gives way to a shrieking horn section and a seizing synthesizer reminiscent of LCD Soundsystem\u2019s best work. Electricity is filled with moments like this: of breathtaking sonic rises and falls, astonishing cultural exchanges, and flat-out infectious dance music.\u2014A.R.C. 5. It\u2019s Almost Dry, Pusha T If the rapper and impresario Pusha T is the \u201cMartin Scorsese of street rap,\u201d as he hopes to be, then It\u2019s Almost Dry might just be his Goodfellas: an immersive gangster epic that\u2019s brutal yet stylish, materialistic, and psychologically probing. Pusha T doesn\u2019t stray far from his favorite topic\u2014hustling\u2014but he doesn\u2019t need to, because of the care with which he imbues his wordcraft and storytelling. His dense references will send you scrambling for Genius annotations: \u201dSummertime, Winterfell, I\u2019m the Night King/ The Colgate kilo, the hood needs whitening/ We fishscale n\u2014-s like we all Pisces/ Your bitch in my bubble like I\u2019m still typing,\u201d he raps on \u201cNeck and Wrist.\u201d But even if you don\u2019t catch all the double and triple entendres, the music sounds fantastically luxurious. He recruited some of the most renowned producers in hip-hop, from Kanye West to Pharrell, and they delivered their A-game.\u2014A.R.C. 4. Chloe and the Next 20th Century, Father John Misty The musical polymath Josh Tillman, better known as his stage alter ego, Father John Misty, has made a name for himself as the most polarizing (and possibly most talented) man in the contemporary folk rock scene. With Chloe and the 20th Century, his fifth studio album as FJM, however, he takes a surprising and delightful departure from his usual form for a project that\u2019s grandiose in its ambition, theatrical in its presentation, and thrilling in its execution. Drawing on elements like big band, bossa nova, and film scores from the golden age of Hollywood, the album is a lush and lofty epic that spins fictional vintage narratives into song. Through tragic vignettes that read like a screenplay of a fantasy L.A., the tracks detail torrid love affairs, untimely ends, and heartbreak, for the titular Chloe and her motley crew, showcasing not only FJM\u2019s signature wry cynicism and penchant for melodrama, but an impressive flair for worldbuilding.\u2014C.L. 3. Renaissance, Beyonc\u00e9 Ahead of the release of Renaissance, her seventh solo studio album, Beyonc\u00e9 shared via social media that it was a creative project born out of a need for escape, freedom, and exploration during the pandemic. The spirit of release is omnipresent in the album, a true celebration of dance music and its Black queer history. From her first single off the album, \u201cBreak My Soul,\u201d where Bey and Big Freedia urge us to \u201crelease your job/ release the time\u201d to the dedication of the album to her late queer uncle, Johnny, the album is an homage to the Black queer pioneers of genres like disco, bounce, house, techno, funk, and ballroom. There are few artists who can drop an album late in the game and still commandeer \u201csong of the summer\u201d along with every dance floor, but as she tells us on \u201cAlien Superstar,\u201d Beyonc\u00e9 is and forever will be that girl.\u2014C.L. 2. 19 Masters, Saya Gray The debut album from the Toronto-based singer-songwriter Gray is not for the stadium rafters. It\u2019s full of half-fleshed-out ideas, spindly guitar wanderings, washed-out vocal recordings and stray voice memos. But Gray\u2019s strange restraint and restless curiosity are entirely the point: In its scattered and shaggy structure, there\u2019s something compelling to be found around every melodic corner, whether on your second or tenth listen. In this way, the album feels like a worthy inheritor of Frank Ocean\u2019s lo-fi masterpiece Blonde. Gray layers her scratchy voice upon itself to build breathtaking harmonies, and the tones she wrings out of her guitar and bass are impeccable.\u2014A.R.C. 1. Un Verano Sin Ti, Bad Bunny No other album had as much universal appeal (and, let\u2019s be honest, adoration) this year than Un Verano Sin Ti, Bad Bunny\u2019s glorious fourth solo studio album. It\u2019s an album about heartbreak, yes, but also a veritable love letter to his homeland of Puerto Rico and a sonic tribute to the Caribbean diaspora. Driven by the musical styles of El Caribe, ranging from reggaeton and dembow to merengue and cumbia, and bolstered by elements of dance hall and techno, Benito firmly roots the album in the deeply personal, mining the universal experiences of love, loss, and the supreme pleasure of being alive, for an exceptional project that is genre-defying, intergenerational, and groundbreaking. Never one to shy away from getting political, Bad Bunny also uses the project to critique hot-button issues, from the privatization of power in Puerto Rico to how the current crisis of gentrification on the island is part of a long and troubled history of colonization. To listen to this album, to move to it and be moved by it, is an act of defiance, celebration, and radical love.\u2014C.L. More Must-Reads From TIME Essay: I Fell for a Famed Artist. Then He Got Violent Pride, Against All Odds Inside Zelensky's Battle Against Russian Propaganda How the Women\u2019s World Cup Evolved Into What It Is Today The Dangers of Unregulated Deep-Sea Tourism Podcast: Elliott Page Steps Into His Truth OpenAI's CEO Sam Altman Is Pushing Past Doubts on Artificial Intelligence These Are the 100 Most Influential Companies of 2023 Write to Cady Lang at cady.lang@timemagazine.com and Moises Mendez II at moises.mendez@time.com. You May Also Like Read Next Why Verified Fan Is Ruining the Concert Experience Next Up: Editor's Pick Underwater Noise Pollution Is Disrupting Ocean Life\u2014But We Can Fix It EDIT POST Home U.S. Politics World Health Business Tech Personal Finance by TIME Stamped Shopping by TIME Stamped Future of Work by Charter Entertainment Ideas Science History Newsfeed Sports Magazine The TIME Vault TIME For Kids TIME CO2 TIME Edge Video Masthead Newsletters Subscribe Subscriber Benefits Give a Gift Shop the TIME Store Careers Press Room TIME Studios U.S. & Canada Customer Care Global Help Center Contact the Editors Reprints and Permissions Site Map Media Kit Supplied Partner Content About Us \u00a9 2023 TIME USA, LLC. All Rights Reserved. Use of this site constitutes acceptance of our Terms of Service, Privacy Policy (Your California Privacy Rights) and Do Not Sell or Share My Personal Information. TIME may receive compensation for some links to products and services on this website. Offers may be subject to change without notice.\n```\nNow help me write a SQL query to store the answer into a temp view.\nHere is an example of how to store data into a temp view:\n```\nCREATE OR REPLACE TEMP VIEW movies AS SELECT * FROM VALUES('Citizen Kane', 1941), ('Schindler's List', 1993) AS v1(title, year)\n```\nThe result view MUST contain following columns: ['album', 'artist', 'year']\nThe answer MUST contain query only.\n", "value": "CREATE OR REPLACE TEMP VIEW best_albums_2022 AS SELECT * FROM VALUES\n('Motomami', 'Rosal\u00eda', 2022),\n('You Can\u2019t Kill Me', '070 Shake', 2022),\n('Mr. Morale & The Big Steppers', 'Kendrick Lamar', 2022),\n('Big Time', 'Angel Olsen', 2022),\n('Electricity', 'Ibibio Sound Machine', 2022),\n('It\u2019s Almost Dry', 'Pusha T', 2022),\n('Chloe and the Next 20th Century', 'Father John Misty', 2022),\n('Renaissance', 'Beyonc\u00e9', 2022),\n('19 Masters', 'Saya Gray', 2022),\n('Un Verano Sin Ti', 'Bad Bunny', 2022)\nAS v1(album, artist, year)"}
{"key": "\nGiven 1) a PySpark dataframe, df, and 2) a description of expected properties, desc,\ngenerate a Python function to test whether the given dataframe satisfies the expected properties.\nYour generated function should take 1 parameter, df, and the return type should be a boolean.\nYou will call the function, passing in df as the parameter, and return the output (True/False).\n\nIn total, your output must follow the format below, exactly (no explanation words):\n1. function definition f, in Python\n2. 1 blank new line\n3. Call f on df and assign the result to a variable, result: result = name_of_f(df)\n\nInclude any necessary import statements INSIDE the function definition.\nFor example:\ndef gen_random():\n    import random\n    return random.randint(0, 10)\n\nFor example:\nInput:\ndf = DataFrame[name: string, age: int]\ndesc = \"expect 5 columns\"\n\nOutput:\n\"def has_5_columns(df) -> bool:\n    # Get the number of columns in the DataFrame\n    num_columns = len(df.columns)\n\n    # Check if the number of columns is equal to 5\n    if num_columns == 5:\n        return True\n    else:\n        return False\n\nresult = has_5_columns(df)\"\n\nHere is your input df: DataFrame[album: string, artist: string, year: int]\nHere is your input description: expect each year to be 2022\n", "value": "def has_year_2022(df) -> bool:\n    from pyspark.sql.functions import col\n\n    # Filter the DataFrame to only include rows where the year is 2022\n    df_filtered = df.filter(col(\"year\") == 2022)\n\n    # Check if the number of rows in the filtered DataFrame is equal to the number of rows in the original DataFrame\n    if df_filtered.count() == df.count():\n        return True\n    else:\n        return False\n\nresult = has_year_2022(df)"}
{"key": "\nThis is the documentation for a PySpark user-defined function (udf): pyspark.sql.functions.udf\n\nA udf creates a deterministic, reusable function in Spark. It can take any data type as a parameter, \nand by default returns a String (although it can return any data type). \nThe point is to reuse a function on several dataframes and SQL functions.\n\nGiven 1) input arguments, 2) a description of the udf functionality,\n3) the udf return type, and 4) the udf function name, \ngenerate and return a callable udf.\n        \nReturn ONLY the callable resulting udf function (no explanation words). \nInclude any necessary import statements INSIDE the function definition.\nFor example:\ndef gen_random():\n    import random\n    return random.randint(0, 10)\n\n\n\ninput_args_types: (s: str)\ndesc: Convert string s to uppercase\nreturn_type: str\nudf_name: to_upper\noutput: \ndef to_upper(s) -> str:\n    if s is not None:\n        return s.upper()\n\n\n\n\ninput_args_types: (x: int)\ndesc: Add 1\nreturn_type: int\nudf_name: add_one\noutput: \ndef add_one(x) -> int:\n    if x is not None:\n        return x + 1\n\n\n\n\ninput_args_types: (grade_percent: float)\ninput_desc: Convert the grade percent to a letter grade using standard cutoffs\nreturn_type: str\nudf_name: convert_grades\noutput:\n\n", "value": "def convert_grades(grade_percent: float) -> str:\n    if grade_percent is not None:\n        if grade_percent >= 90:\n            return \"A\"\n        elif grade_percent >= 80:\n            return \"B\"\n        elif grade_percent >= 70:\n            return \"C\"\n        elif grade_percent >= 60:\n            return \"D\"\n        else:\n            return \"F\""}
